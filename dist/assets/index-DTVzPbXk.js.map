{"version":3,"mappings":"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","names":["Router","constructor","this","routes","Map","currentRoute","addRoute","pattern","handler","set","regex","patternToRegex","withParams","replace","RegExp","concat","navigate","path","startsWith","window","location","pathname","search","history","pushState","handleRoute","basePath","slice","console","log","route","match","params","groups","updateActiveNavigation","error","warn","handle404","document","querySelectorAll","forEach","el","classList","remove","link","href","getAttribute","add","parentCategory","closest","mainContent","querySelector","innerHTML","getCurrentRoute","buildUrl","ComponentLoader","cache","loadingPromises","loadPartial","url","useCache","has","get","loadingPromise","fetchPartial","html","delete","response","fetch","ok","Error","status","statusText","text","trim","includes","getHeaderFallback","getNavigationFallback","getFooterFallback","Date","getFullYear","loadJSON","data","json","loadMarkdown","markdown","clearCache","clear","getCacheStats","size","keys","Array","from","LanguageManager","currentLanguage","supportedLanguages","translations","observers","Set","init","savedLanguage","localStorage","getItem","loadCoreTranslations","applyTranslations","coreTranslations","en","searchPlaceholder","switchToSpanish","loadingPresentation","noResults","searchResults","footer_copyright","supportModalTitle","supportModalDescription","buyMeCoffee","close","pageNotFound","returnHome","loading","es","getCurrentLanguage","getSupportedLanguages","setLanguage","language","setItem","notifyObservers","app","reloadCurrentSpecialtyNavigation","toggleLanguage","newLanguage","currentTrans","searchInput","getElementById","placeholder","translateButton","textContent","title","loadingIndicator","footerCopyright","element","key","translate","category","fallback","categoryTranslations","loadSpecialtyTranslations","specialty","navData","then","r","ui_strings","subscribe","callback","formatText","options","capitalize","charAt","toUpperCase","getDirection","getLanguageDisplayName","SearchManager","searchData","searchIndex","searchTimeout","selectedIndex","minSearchLength","maxResults","loadSearchData","buildSearchIndex","initializeSearchUI","sitePages","isArray","searchScript","jsonStr","JSON","parse","parseError","eval","evalError","page","pageIndex","description","keywords","join","toLowerCase","word","length","addEventListener","event","clearTimeout","setTimeout","performSearch","target","value","handleKeyDown","contains","hideResults","query","results","displayResults","normalizedQuery","queryWords","candidatePages","pageIndices","indexWord","map","score","calculateRelevanceScore","index","filter","result","sort","a","b","searchText","titleLower","term","languageManager","_a","noResultsText","escapeHTML","style","display","highlightedResults","highlightedTitle","highlightSearchTerms","highlightedDescription","item","router","escapedText","highlightedText","escapeRegex","e","items","preventDefault","Math","min","updateSelection","max","blur","toggle","addPage","pageData","newIndex","push","str","getSearchStats","totalPages","indexSize","averageWordsPerPage","reduce","sum","ContentManager","contentCache","metadataCache","contentIndex","markedRenderer","setupMarkdownRenderer","urlMappings","initializeUrlMappings","neurology","dermatology","getBasePath","marked","setOptions","highlight","code","breaks","gfm","renderer","Renderer","heading","level","titleAttr","table","header","body","use","loadContent","contentId","lang","mappedContentId","mapContentId","cacheKey","markdownContent","metadata","Promise","all","loadMarkdownContent","loadContentMetadata","processedContent","processContent","originalContentId","createErrorContent","markdownPath","createFallbackMarkdown","metadataPath","translationStatus","getTranslationStatus","createDefaultMetadata","content","frontmatter","parseFrontmatter","combinedMetadata","htmlContent","sanitizedContent","DOMPurify","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","addMedicalIndicators","rawMarkdown","lastModified","toISOString","frontmatterText","split","line","colonIndex","indexOf","substring","endsWith","frequency","mortality","indicators","freqSymbol","getFrequencySymbol","mortSymbol","getMortalitySymbol","indicatorHTML","high","medium","low","l","setting","lastUpdated","author","message","indexContent","indexKey","getAllIndexedContent","values","getContentBySpecialty","entries","cacheType","totalCachedItems","statusData","contentKey","contentStatus","languages","trans","autoTranslated","humanReviewRequired","getAvailableLanguages","isContentTranslated","navigationCache","clearNavigationCache","async","getNavigationData","fileName","InteractiveAppManager","loadedApps","appRegistry","modalContainer","setupAppRegistry","name","module","__vitePreload","import","className","launchApp","appId","appConfig","modalId","now","containerId","createModalContainer","AppClass","appInstance","instance","setupModalEventHandlers","showErrorModal","showComingSoonModal","modal","createElement","id","appendChild","closeBtn","appData","closeApp","escapeHandler","removeEventListener","container","destroy","closeAllApps","parentNode","getAvailableApps","apps","config","available","Boolean","getAppsBySpecialty","appsBySpecialty","isAppLoaded","some","getLoadedApps","addInteractiveAppStyles","head","interactiveAppManager","ConductMedicineApp","componentLoader","searchManager","contentManager","isInitialized","currentSpecialty","detectBasePath","fullPath","loadPersistentComponents","setupRouting","initializeInteractions","debugConductMedicine","reloadCurrentSpecialty","loadSpecialtyNavigation","forceRefreshNavigation","originalFetch","showErrorMessage","headerHTML","headerPlaceholder","outerHTML","navHTML","navPlaceholder","footerHTML","footerPlaceholder","overlayHTML","overlayPlaceholder","lucide","createIcons","loadMainPage","loadSpecialtyPage","loadSpecialtyContent","loadInteractiveTool","tool","shouldHandleInternally","URL","origin","generalNavInitialized","neurologyNavInitialized","dermatologyNavInitialized","navPanel","loadGeneralNavigation","loadMainPresentation","loadSpecialtyPresentation","retries","maxRetries","resolve","uiStrings","sections","navHtml","section","titleTextHtml","sectionTitleForId","sectionTitleObj","sectionTitleText","generateSafeId","historicalFigure","figure","altText","charcotImageAlt","charcotImageTitle","wikipediaUrl","imageUrl","itemLabelObj","label","itemLabelText","itemId","subItems","subMenuId","subItem","subItemLabelObj","subItemLabelText","subItemId","legendHtmlString","legendTitle","legendFC","legendHigh","legendMedium","legendLow","legendMA","legendIndicators","context","attachNavigationEventListeners","categoryTitles","categoryLi","subMenu","nextElementSibling","createBasicNavigation","navStructure","sectionId","sectionTitle","itemLabel","subItemLabel","handleNavigationClick","handleNavigationKeydown","categoryTitle","stopPropagation","toggleNavigationCategory","titleElement","icon","isExpanded","setAttribute","String","newIconName","elements","presentationWrapper","loadAndInitializeReveal","contentHTML","generateLanguageIndicators","toLocaleDateString","generateTranslationStatus","interactiveTools","renderInteractiveTools","relatedContent","renderRelatedContent","initializeContentInteractions","currentPath","tools","relatedItems","button","launchInteractiveTool","showModal","open","setupMobileNavigation","setupLanguageSwitcher","setupSearchInteractions","setupModalSystem","mobileToggle","overlay","ctrlKey","metaKey","focus","select","showSupportModal","errorDiv","isActive","flag","langName","statusHTML","reviewedBy","readyState"],"ignoreList":[],"sources":["../../src/utils/router.js","../../src/utils/component-loader.js","../../src/utils/language-manager.js","../../src/utils/search-manager.js","../../src/utils/content-manager.js","../../src/utils/navigation-data.js","../../src/utils/interactive-app-manager.js","../../src/main.js"],"sourcesContent":["// src/utils/router.js - Simple SPA router\nexport class Router {\n  constructor() {\n    this.routes = new Map();\n    this.currentRoute = null;\n  }\n\n  addRoute(pattern, handler) {\n    this.routes.set(pattern, {\n      pattern,\n      handler,\n      regex: this.patternToRegex(pattern)\n    });\n  }\n\n  patternToRegex(pattern) {\n    // Convert route patterns like '/specialty/:specialty/:page' to regex\n    const escaped = pattern.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    const withParams = escaped.replace(/:(\\w+)/g, '(?<$1>[^/]+)');\n    return new RegExp(`^${withParams}$`);\n  }\n\n  navigate(path) {\n    // Ensure path always starts with /\n    if (!path.startsWith('/')) {\n      path = '/' + path;\n    }\n    \n    // Update browser history\n    if (window.location.pathname + window.location.search !== path) {\n      window.history.pushState(null, '', path);\n    }\n    this.handleRoute(path);\n  }\n\n  async handleRoute(path = window.location.pathname) {\n    // Ensure path always starts with /\n    if (!path.startsWith('/')) {\n      path = '/' + path;\n    }\n    \n    // Strip base path for GitHub Pages deployment if present in URL\n    const basePath = '/conduct_medicine';\n    \n    // Strip base path in both dev and production if it's present in the URL\n    if (path.startsWith(basePath)) {\n      path = path.slice(basePath.length) || '/';\n    }\n    \n    console.log(`🔗 Routing to: ${path}`);\n    \n    // Find matching route\n    for (const [pattern, route] of this.routes) {\n      const match = path.match(route.regex);\n      if (match) {\n        this.currentRoute = pattern;\n        \n        // Extract parameters\n        const params = match.groups || {};\n        \n        // Call route handler\n        try {\n          await route.handler(params);\n          this.updateActiveNavigation(path);\n          return;\n        } catch (error) {\n          console.error(`Error handling route ${pattern}:`, error);\n        }\n      }\n    }\n\n    // No route matched - handle 404\n    console.warn(`No route found for: ${path}`);\n    this.handle404();\n  }\n\n  \n\n  updateActiveNavigation(path) {\n    // Update active navigation states\n    document.querySelectorAll('.nav-link-active, .nav-category-active').forEach(el => {\n      el.classList.remove('nav-link-active', 'nav-category-active');\n    });\n\n    // Find and highlight current navigation item\n    const navLinks = document.querySelectorAll('a[href]');\n    navLinks.forEach(link => {\n      const href = link.getAttribute('href');\n      if (href === path || (path.startsWith(href) && href !== '/')) {\n        link.classList.add('nav-link-active');\n        \n        // Also highlight parent categories\n        const parentCategory = link.closest('.nav-category');\n        if (parentCategory) {\n          parentCategory.classList.add('nav-category-active');\n        }\n      }\n    });\n  }\n\n  handle404() {\n    const mainContent = document.querySelector('.actual-main-content');\n    if (mainContent) {\n      mainContent.innerHTML = `\n        <h2 class=\"text-2xl font-semibold mb-4 text-gray-100\">Page Not Found</h2>\n        <p class=\"mb-4\">The requested page could not be found.</p>\n        <a href=\"/\" class=\"text-sky-400 hover:text-sky-300\">← Return to Home</a>\n      `;\n    }\n  }\n\n  getCurrentRoute() {\n    return this.currentRoute;\n  }\n\n  // Utility method to build URLs with base path for GitHub Pages\n  buildUrl(path) {\n    const base = import.meta.env.BASE_URL || '/';\n    return base + path.replace(/^\\//, '');\n  }\n}","// src/utils/component-loader.js - Load HTML partials and components\nexport class ComponentLoader {\n  constructor() {\n    this.cache = new Map();\n    this.loadingPromises = new Map();\n  }\n\n  async loadPartial(url, useCache = true) {\n    // Return cached version if available\n    if (useCache && this.cache.has(url)) {\n      return this.cache.get(url);\n    }\n\n    // Return existing loading promise if in progress\n    if (this.loadingPromises.has(url)) {\n      return this.loadingPromises.get(url);\n    }\n\n    // Start loading\n    const loadingPromise = this.fetchPartial(url);\n    this.loadingPromises.set(url, loadingPromise);\n\n    try {\n      const html = await loadingPromise;\n      \n      // Cache the result\n      if (useCache) {\n        this.cache.set(url, html);\n      }\n      \n      this.loadingPromises.delete(url);\n      return html;\n      \n    } catch (error) {\n      this.loadingPromises.delete(url);\n      throw error;\n    }\n  }\n\n  async fetchPartial(url) {\n    try {\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const html = await response.text();\n      \n      if (!html.trim()) {\n        console.warn(`Partial ${url} is empty`);\n        return '';\n      }\n      \n      return html;\n      \n    } catch (error) {\n      console.error(`Failed to load partial ${url}:`, error);\n      \n      // Return fallback content for critical components\n      if (url.includes('_header')) {\n        return this.getHeaderFallback();\n      } else if (url.includes('_navigation_shell')) {\n        return this.getNavigationFallback();\n      } else if (url.includes('_footer')) {\n        return this.getFooterFallback();\n      }\n      \n      return `<div class=\"error-placeholder\">Failed to load ${url}</div>`;\n    }\n  }\n\n  getHeaderFallback() {\n    return `\n      <header class=\"site-header\">\n        <div class=\"header-content\">\n          <h1 class=\"site-title\">Conduct Based Medicine</h1>\n          <div class=\"header-controls\">\n            <input type=\"text\" id=\"search-input\" placeholder=\"Search...\" class=\"search-input\">\n            <button id=\"translate-button\" class=\"translate-button\">ES</button>\n            <button id=\"mobile-nav-toggle\" class=\"mobile-nav-toggle\">☰</button>\n          </div>\n        </div>\n        <div id=\"search-results-preview\" class=\"search-results-preview\"></div>\n      </header>\n    `;\n  }\n\n  getNavigationFallback() {\n    return `\n      <aside class=\"site-navigation-panel\">\n        <nav class=\"navigation-content\">\n          <p class=\"text-gray-400 p-4\">Navigation loading...</p>\n        </nav>\n      </aside>\n    `;\n  }\n\n  getFooterFallback() {\n    return `\n      <footer class=\"site-footer\">\n        <p>&copy; ${new Date().getFullYear()} JP Silva. All rights reserved.</p>\n      </footer>\n    `;\n  }\n\n  // Load and parse JSON data\n  async loadJSON(url, useCache = true) {\n    if (useCache && this.cache.has(url)) {\n      return this.cache.get(url);\n    }\n\n    try {\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      \n      if (useCache) {\n        this.cache.set(url, data);\n      }\n      \n      return data;\n      \n    } catch (error) {\n      console.error(`Failed to load JSON ${url}:`, error);\n      throw error;\n    }\n  }\n\n  // Load markdown content\n  async loadMarkdown(url, useCache = true) {\n    if (useCache && this.cache.has(url)) {\n      return this.cache.get(url);\n    }\n\n    try {\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const markdown = await response.text();\n      \n      if (useCache) {\n        this.cache.set(url, markdown);\n      }\n      \n      return markdown;\n      \n    } catch (error) {\n      console.error(`Failed to load Markdown ${url}:`, error);\n      throw error;\n    }\n  }\n\n  // Clear cache for specific URL or all\n  clearCache(url = null) {\n    if (url) {\n      this.cache.delete(url);\n    } else {\n      this.cache.clear();\n    }\n  }\n\n  // Get cache statistics\n  getCacheStats() {\n    return {\n      size: this.cache.size,\n      keys: Array.from(this.cache.keys())\n    };\n  }\n}","// src/utils/language-manager.js - Manage bilingual content\nexport class LanguageManager {\n  constructor() {\n    this.currentLanguage = 'en';\n    this.supportedLanguages = ['en', 'es'];\n    this.translations = new Map();\n    this.observers = new Set();\n  }\n\n  async init() {\n    // Load saved language preference\n    const savedLanguage = localStorage.getItem('preferredLanguage');\n    if (savedLanguage && this.supportedLanguages.includes(savedLanguage)) {\n      this.currentLanguage = savedLanguage;\n    }\n\n    // Make current language globally available (for compatibility with existing code)\n    window.currentLanguage = this.currentLanguage;\n\n    // Load core translations\n    await this.loadCoreTranslations();\n\n    // Apply initial translations\n    this.applyTranslations();\n  }\n\n  async loadCoreTranslations() {\n    // Core translations for global UI elements\n    const coreTranslations = {\n      en: {\n        searchPlaceholder: \"Search medical content...\",\n        switchToSpanish: \"Switch to Spanish\",\n        loadingPresentation: \"Loading presentation...\",\n        noResults: \"No results found\",\n        searchResults: \"Search Results\",\n        footer_copyright: `© ${new Date().getFullYear()} JP Silva. All rights reserved.`,\n        supportModalTitle: \"Support Our Medical Education Platform\",\n        supportModalDescription: \"Help us maintain and expand this clinical decision support tool.\",\n        buyMeCoffee: \"☕ Buy me a coffee\",\n        close: \"Close\",\n        pageNotFound: \"Page Not Found\",\n        returnHome: \"← Return to Home\",\n        loading: \"Loading...\",\n        error: \"Error\"\n      },\n      es: {\n        searchPlaceholder: \"Buscar contenido médico...\",\n        switchToSpanish: \"Cambiar a Inglés\",\n        loadingPresentation: \"Cargando presentación...\",\n        noResults: \"No se encontraron resultados\",\n        searchResults: \"Resultados de Búsqueda\",\n        footer_copyright: `© ${new Date().getFullYear()} JP Silva. Todos los derechos reservados.`,\n        supportModalTitle: \"Apoya Nuestra Plataforma de Educación Médica\",\n        supportModalDescription: \"Ayúdanos a mantener y expandir esta herramienta de apoyo a decisiones clínicas.\",\n        buyMeCoffee: \"☕ Invítame un café\",\n        close: \"Cerrar\",\n        pageNotFound: \"Página No Encontrada\",\n        returnHome: \"← Volver al Inicio\",\n        loading: \"Cargando...\",\n        error: \"Error\"\n      }\n    };\n\n    this.translations.set('core', coreTranslations);\n    \n    // Make translations globally available for compatibility\n    window.translations = coreTranslations;\n  }\n\n  getCurrentLanguage() {\n    return this.currentLanguage;\n  }\n\n  getSupportedLanguages() {\n    return [...this.supportedLanguages];\n  }\n\n  async setLanguage(language) {\n    if (!this.supportedLanguages.includes(language)) {\n      console.warn(`Language ${language} not supported`);\n      return false;\n    }\n\n    if (this.currentLanguage === language) {\n      return true; // No change needed\n    }\n\n    this.currentLanguage = language;\n    window.currentLanguage = language; // Update global for compatibility\n\n    // Save preference\n    localStorage.setItem('preferredLanguage', language);\n\n    // Apply translations\n    this.applyTranslations();\n\n    // Notify observers\n    this.notifyObservers();\n\n    // Trigger specialty navigation rebuild if we're on a specialty page\n    if (window.app && typeof window.app.reloadCurrentSpecialtyNavigation === 'function') {\n      window.app.reloadCurrentSpecialtyNavigation();\n    }\n\n    return true;\n  }\n\n  toggleLanguage() {\n    const newLanguage = this.currentLanguage === 'en' ? 'es' : 'en';\n    return this.setLanguage(newLanguage);\n  }\n\n  applyTranslations() {\n    const coreTranslations = this.translations.get('core');\n    if (!coreTranslations || !coreTranslations[this.currentLanguage]) {\n      return;\n    }\n\n    const currentTrans = coreTranslations[this.currentLanguage];\n\n    // Update search placeholder\n    const searchInput = document.getElementById('search-input');\n    if (searchInput) {\n      searchInput.placeholder = currentTrans.searchPlaceholder;\n    }\n\n    // Update translate button\n    const translateButton = document.getElementById('translate-button');\n    if (translateButton) {\n      translateButton.textContent = this.currentLanguage === 'en' ? 'ES' : 'EN';\n      translateButton.title = currentTrans.switchToSpanish;\n    }\n\n    // Update loading indicator\n    const loadingIndicator = document.getElementById('loading-indicator');\n    if (loadingIndicator) {\n      loadingIndicator.textContent = currentTrans.loadingPresentation;\n    }\n\n    // Update footer\n    const footerCopyright = document.querySelector('[data-translate-key=\"footer_copyright\"]');\n    if (footerCopyright) {\n      footerCopyright.innerHTML = currentTrans.footer_copyright;\n    }\n\n    // Update any elements with data-translate attributes\n    document.querySelectorAll('[data-translate]').forEach(element => {\n      const key = element.getAttribute('data-translate');\n      if (currentTrans[key]) {\n        element.textContent = currentTrans[key];\n      }\n    });\n  }\n\n  // Get translation for a specific key\n  translate(key, category = 'core', fallback = key) {\n    const categoryTranslations = this.translations.get(category);\n    if (categoryTranslations && \n        categoryTranslations[this.currentLanguage] && \n        categoryTranslations[this.currentLanguage][key]) {\n      return categoryTranslations[this.currentLanguage][key];\n    }\n\n    // Try English fallback\n    if (this.currentLanguage !== 'en' && \n        categoryTranslations && \n        categoryTranslations.en && \n        categoryTranslations.en[key]) {\n      return categoryTranslations.en[key];\n    }\n\n    return fallback;\n  }\n\n  // Load specialty-specific translations\n  async loadSpecialtyTranslations(specialty) {\n    if (this.translations.has(specialty)) {\n      return this.translations.get(specialty);\n    }\n\n    try {\n      // Try to load from navigation menu JSON (which includes ui_strings)\n      const navData = await fetch(`assets/data/navigation-menu-${specialty}.json`).then(r => r.json());\n      \n      if (navData.ui_strings) {\n        this.translations.set(specialty, navData.ui_strings);\n        return navData.ui_strings;\n      }\n    } catch (error) {\n      console.warn(`Could not load ${specialty} translations:`, error);\n    }\n\n    return null;\n  }\n\n  // Observer pattern for language changes\n  subscribe(callback) {\n    this.observers.add(callback);\n    return () => this.observers.delete(callback);\n  }\n\n  notifyObservers() {\n    this.observers.forEach(callback => {\n      try {\n        callback(this.currentLanguage);\n      } catch (error) {\n        console.error('Error in language change observer:', error);\n      }\n    });\n  }\n\n  // Format text with language-specific rules\n  formatText(text, options = {}) {\n    if (!text) return '';\n\n    // Apply language-specific formatting rules\n    switch (this.currentLanguage) {\n      case 'es':\n        // Spanish-specific formatting\n        if (options.capitalize) {\n          return text.charAt(0).toUpperCase() + text.slice(1);\n        }\n        break;\n      case 'en':\n      default:\n        // English formatting\n        if (options.capitalize) {\n          return text.charAt(0).toUpperCase() + text.slice(1);\n        }\n        break;\n    }\n\n    return text;\n  }\n\n  // Get language direction (for future RTL support)\n  getDirection() {\n    return 'ltr'; // All currently supported languages are LTR\n  }\n\n  // Get language display name\n  getLanguageDisplayName(language = this.currentLanguage) {\n    const displayNames = {\n      en: 'English',\n      es: 'Español'\n    };\n    return displayNames[language] || language;\n  }\n}","// src/utils/search-manager.js - Enhanced search functionality\nexport class SearchManager {\n  constructor() {\n    this.searchData = [];\n    this.searchIndex = new Map();\n    this.searchTimeout = null;\n    this.selectedIndex = -1;\n    this.minSearchLength = 2;\n    this.maxResults = 10;\n  }\n\n  async init() {\n    // Load search data\n    await this.loadSearchData();\n    \n    // Build search index\n    this.buildSearchIndex();\n    \n    // Initialize search UI\n    this.initializeSearchUI();\n  }\n\n  async loadSearchData() {\n    try {\n      // Check if sitePages is already loaded globally\n      if (window.sitePages && Array.isArray(window.sitePages)) {\n        this.searchData = window.sitePages;\n        return;\n      }\n      \n      // Load existing search data script with correct base path for dev/prod\n      const basePath = import.meta.env.DEV ? '/conduct_medicine' : '';\n      const response = await fetch(`${basePath}/assets/js/search-data.js`);\n      if (!response.ok) {\n        throw new Error(`Failed to fetch search data: ${response.status}`);\n      }\n      \n      const searchScript = await response.text();\n      \n      // Extract sitePages array from the script using regex\n      const match = searchScript.match(/const sitePages = (\\[[\\s\\S]*?\\]);/);\n      if (match) {\n        // Clean up the extracted JSON (remove comments and fix formatting)\n        let jsonStr = match[1];\n        // Remove JavaScript comments\n        jsonStr = jsonStr.replace(/\\/\\/[^\\n\\r]*/g, '');\n        \n        try {\n          this.searchData = JSON.parse(jsonStr);\n        } catch (parseError) {\n          console.warn('Could not parse extracted JSON, trying eval approach');\n          // Fallback: use eval in safe context\n          try {\n            this.searchData = eval(match[1]);\n          } catch (evalError) {\n            throw new Error('Could not parse search data');\n          }\n        }\n      } else {\n        throw new Error('Could not find sitePages array in search-data.js');\n      }\n      \n      // Make it globally available for compatibility\n      window.sitePages = this.searchData;\n      \n    } catch (error) {\n      console.error('Failed to load search data:', error);\n      this.searchData = [];\n      // Create minimal fallback data\n      window.sitePages = this.searchData;\n    }\n  }\n\n  buildSearchIndex() {\n    // Create inverted index for faster searching\n    this.searchIndex.clear();\n    \n    this.searchData.forEach((page, pageIndex) => {\n      const searchText = [\n        page.title,\n        page.description,\n        page.keywords\n      ].join(' ').toLowerCase();\n      \n      // Split into words and build index\n      const words = searchText.match(/\\b\\w+\\b/g) || [];\n      \n      words.forEach(word => {\n        if (word.length >= 2) { // Only index words with 2+ characters\n          if (!this.searchIndex.has(word)) {\n            this.searchIndex.set(word, new Set());\n          }\n          this.searchIndex.get(word).add(pageIndex);\n        }\n      });\n    });\n  }\n\n  initializeSearchUI() {\n    const searchInput = document.getElementById('search-input');\n    const searchResults = document.getElementById('search-results-preview');\n    \n    if (!searchInput || !searchResults) {\n      return;\n    }\n\n    // Input event handler\n    searchInput.addEventListener('input', (event) => {\n      clearTimeout(this.searchTimeout);\n      this.searchTimeout = setTimeout(() => {\n        this.performSearch(event.target.value);\n      }, 200);\n    });\n\n    // Keyboard navigation\n    searchInput.addEventListener('keydown', (event) => {\n      this.handleKeyDown(event, searchResults);\n    });\n\n    // Focus handler\n    searchInput.addEventListener('focus', () => {\n      if (searchInput.value.trim()) {\n        this.performSearch(searchInput.value);\n      }\n    });\n\n    // Click outside to close\n    document.addEventListener('click', (event) => {\n      if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {\n        this.hideResults();\n      }\n    });\n  }\n\n  performSearch(query) {\n    const searchResults = document.getElementById('search-results-preview');\n    if (!searchResults) return;\n\n    // Hide results for empty or short queries\n    if (!query.trim() || query.length < this.minSearchLength) {\n      this.hideResults();\n      return;\n    }\n\n    // Perform the search\n    const results = this.search(query);\n    this.displayResults(results, query);\n  }\n\n  search(query) {\n    const normalizedQuery = query.toLowerCase().trim();\n    const queryWords = normalizedQuery.match(/\\b\\w+\\b/g) || [];\n    \n    if (queryWords.length === 0) return [];\n\n    // Find pages that contain any of the query words\n    const candidatePages = new Set();\n    \n    queryWords.forEach(word => {\n      // Exact match\n      if (this.searchIndex.has(word)) {\n        this.searchIndex.get(word).forEach(pageIndex => {\n          candidatePages.add(pageIndex);\n        });\n      }\n      \n      // Partial matches (for words that start with the query word)\n      if (word.length >= 3) {\n        this.searchIndex.forEach((pageIndices, indexWord) => {\n          if (indexWord.startsWith(word)) {\n            pageIndices.forEach(pageIndex => {\n              candidatePages.add(pageIndex);\n            });\n          }\n        });\n      }\n    });\n\n    // Score and rank results\n    const results = Array.from(candidatePages)\n      .map(pageIndex => {\n        const page = this.searchData[pageIndex];\n        const score = this.calculateRelevanceScore(page, normalizedQuery, queryWords);\n        return { ...page, score, index: pageIndex };\n      })\n      .filter(result => result.score > 0)\n      .sort((a, b) => b.score - a.score)\n      .slice(0, this.maxResults);\n\n    return results;\n  }\n\n  calculateRelevanceScore(page, query, queryWords) {\n    let score = 0;\n    const searchText = [page.title, page.description, page.keywords].join(' ').toLowerCase();\n    \n    // Exact phrase match (highest score)\n    if (searchText.includes(query)) {\n      score += 100;\n    }\n    \n    // Title matches (high score)\n    const titleLower = page.title.toLowerCase();\n    if (titleLower.includes(query)) {\n      score += 50;\n    }\n    \n    // Individual word matches\n    queryWords.forEach(word => {\n      if (titleLower.includes(word)) {\n        score += 20;\n      }\n      if (page.description.toLowerCase().includes(word)) {\n        score += 10;\n      }\n      if (page.keywords.toLowerCase().includes(word)) {\n        score += 15;\n      }\n    });\n    \n    // Boost common medical terms\n    const medicalTerms = ['neurology', 'dermatology', 'diagnosis', 'treatment', 'management'];\n    medicalTerms.forEach(term => {\n      if (searchText.includes(term) && query.includes(term)) {\n        score += 25;\n      }\n    });\n    \n    return score;\n  }\n\n  displayResults(results, query) {\n    const searchResults = document.getElementById('search-results-preview');\n    if (!searchResults) return;\n\n    if (results.length === 0) {\n      const languageManager = window.app?.languageManager;\n      const noResultsText = languageManager ? \n        languageManager.translate('noResults') : \n        'No results found';\n        \n      searchResults.innerHTML = `\n        <div class=\"search-result-item\">\n          ${this.escapeHTML(noResultsText)}\n        </div>\n      `;\n      searchResults.style.display = 'block';\n      return;\n    }\n\n    const highlightedResults = results.map((result, index) => {\n      const highlightedTitle = this.highlightSearchTerms(result.title, query);\n      const highlightedDescription = this.highlightSearchTerms(result.description, query);\n      \n      return `\n        <div class=\"search-result-item\" data-index=\"${index}\" data-url=\"${this.escapeHTML(result.url)}\">\n          <div class=\"result-snippet-source\">${highlightedTitle}</div>\n          <div class=\"result-snippet-description\">${highlightedDescription}</div>\n          <div class=\"result-snippet-meta\">\n            Score: ${result.score} | Keywords: ${this.escapeHTML(result.keywords)}\n          </div>\n        </div>\n      `;\n    }).join('');\n\n    searchResults.innerHTML = highlightedResults;\n    searchResults.style.display = 'block';\n    this.selectedIndex = -1;\n\n    // Add click handlers\n    searchResults.querySelectorAll('.search-result-item').forEach((item) => {\n      item.addEventListener('click', () => {\n        const url = item.getAttribute('data-url');\n        if (url && window.app?.router) {\n          this.hideResults();\n          window.app.router.navigate(url);\n        }\n      });\n    });\n  }\n\n  highlightSearchTerms(text, query) {\n    if (!query.trim() || typeof text !== 'string') {\n      return this.escapeHTML(text);\n    }\n    \n    const escapedText = this.escapeHTML(text);\n    const queryWords = query.toLowerCase().match(/\\b\\w+\\b/g) || [];\n    \n    let highlightedText = escapedText;\n    \n    queryWords.forEach(word => {\n      if (word.length >= 2) {\n        try {\n          const regex = new RegExp(`\\\\b(${this.escapeRegex(word)})`, 'gi');\n          highlightedText = highlightedText.replace(regex, '<mark class=\"search-preview-highlight\">$1</mark>');\n        } catch (e) {\n          console.warn('Error highlighting search term:', e);\n        }\n      }\n    });\n    \n    return highlightedText;\n  }\n\n  handleKeyDown(event, searchResults) {\n    const items = searchResults.querySelectorAll('.search-result-item');\n    \n    if (searchResults.style.display === 'none' || items.length === 0) {\n      return;\n    }\n\n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        this.selectedIndex = Math.min(this.selectedIndex + 1, items.length - 1);\n        this.updateSelection(items);\n        break;\n        \n      case 'ArrowUp':\n        event.preventDefault();\n        this.selectedIndex = Math.max(this.selectedIndex - 1, 0);\n        this.updateSelection(items);\n        break;\n        \n      case 'Enter':\n        event.preventDefault();\n        if (this.selectedIndex >= 0 && items[this.selectedIndex]) {\n          const url = items[this.selectedIndex].getAttribute('data-url');\n          if (url && window.app?.router) {\n            this.hideResults();\n            window.app.router.navigate(url);\n          }\n        }\n        break;\n        \n      case 'Escape':\n        this.hideResults();\n        event.target.blur();\n        break;\n    }\n  }\n\n  updateSelection(items) {\n    items.forEach((item, index) => {\n      item.classList.toggle('preview-item-selected', index === this.selectedIndex);\n    });\n  }\n\n  hideResults() {\n    const searchResults = document.getElementById('search-results-preview');\n    if (searchResults) {\n      searchResults.style.display = 'none';\n    }\n    this.selectedIndex = -1;\n  }\n\n  // Add new page to search data\n  addPage(pageData) {\n    const newIndex = this.searchData.length;\n    this.searchData.push(pageData);\n    \n    // Update the index\n    const searchText = [\n      pageData.title,\n      pageData.description,\n      pageData.keywords\n    ].join(' ').toLowerCase();\n    \n    const words = searchText.match(/\\b\\w+\\b/g) || [];\n    words.forEach(word => {\n      if (word.length >= 2) {\n        if (!this.searchIndex.has(word)) {\n          this.searchIndex.set(word, new Set());\n        }\n        this.searchIndex.get(word).add(newIndex);\n      }\n    });\n    \n    // Update global sitePages\n    window.sitePages = this.searchData;\n  }\n\n  // Utility functions\n  escapeHTML(str) {\n    if (typeof str !== 'string') return '';\n    return str.replace(/[&<>\"']/g, function (match) {\n      return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#39;' }[match];\n    });\n  }\n\n  escapeRegex(str) {\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  }\n\n  // Get search statistics\n  getSearchStats() {\n    return {\n      totalPages: this.searchData.length,\n      indexSize: this.searchIndex.size,\n      averageWordsPerPage: this.searchData.reduce((sum, page) => {\n        const wordCount = [page.title, page.description, page.keywords]\n          .join(' ').match(/\\b\\w+\\b/g)?.length || 0;\n        return sum + wordCount;\n      }, 0) / this.searchData.length\n    };\n  }\n}","// src/utils/content-manager.js - Hybrid Markdown/JSON Content Management System\nimport { marked } from 'marked';\nimport DOMPurify from 'dompurify';\n\nexport class ContentManager {\n  constructor() {\n    this.contentCache = new Map();\n    this.metadataCache = new Map();\n    this.contentIndex = new Map();\n    this.markedRenderer = this.setupMarkdownRenderer();\n    this.urlMappings = this.initializeUrlMappings();\n  }\n\n  initializeUrlMappings() {\n    // Map navigation URLs to actual content files (only for the two example content pieces)\n    return {\n      'neurology': {\n        'cefaleas-primarias': 'headache-management',\n        'manejo-de-cefaleas-y-dolor': 'headache-management'\n      },\n      'dermatology': {\n        // Dermatology URLs already match filenames, but including for consistency\n        'atopic-dermatitis': 'atopic-dermatitis'\n      }\n    };\n  }\n\n  getBasePath() {\n    // Use Vite's BASE_URL if available (set in vite.config.js)\n    if (typeof import.meta !== 'undefined' && import.meta.env?.BASE_URL) {\n      console.log(`🔍 Using Vite BASE_URL: ${import.meta.env.BASE_URL}`);\n      return import.meta.env.BASE_URL;\n    }\n    \n    // Fallback: detect base path from current location\n    const pathname = window.location.pathname;\n    if (pathname.includes('/conduct_medicine/')) {\n      console.log(`🔍 Detected base path from pathname: /conduct_medicine/`);\n      return '/conduct_medicine/';\n    }\n    \n    // Default for development\n    console.log(`🔍 Using default base path: /`);\n    return '/';\n  }\n\n  setupMarkdownRenderer() {\n    // Configure marked for medical content\n    marked.setOptions({\n      highlight: function(code, language) {\n        // Basic syntax highlighting for code blocks\n        return `<pre class=\"language-${language}\"><code>${code}</code></pre>`;\n      },\n      breaks: true,\n      gfm: true\n    });\n\n    // Custom renderer for medical content\n    const renderer = new marked.Renderer();\n    \n    // Custom heading renderer to add medical context\n    renderer.heading = function(text, level) {\n      const escapedText = text.toLowerCase().replace(/[^\\w]+/g, '-');\n      return `<h${level} id=\"${escapedText}\" class=\"medical-heading level-${level}\">${text}</h${level}>`;\n    };\n\n    // Custom link renderer for internal references\n    renderer.link = function(href, title, text) {\n      const titleAttr = title ? ` title=\"${title}\"` : '';\n      \n      // Handle internal medical references\n      if (href.startsWith('#') || href.startsWith('/')) {\n        return `<a href=\"${href}\"${titleAttr} class=\"internal-link\">${text}</a>`;\n      }\n      \n      // External links open in new tab\n      return `<a href=\"${href}\"${titleAttr} target=\"_blank\" rel=\"noopener noreferrer\" class=\"external-link\">${text}</a>`;\n    };\n\n    // Custom table renderer for medical data\n    renderer.table = function(header, body) {\n      return `<div class=\"medical-table-wrapper\">\n        <table class=\"medical-table\">\n          <thead>${header}</thead>\n          <tbody>${body}</tbody>\n        </table>\n      </div>`;\n    };\n\n    marked.use({ renderer });\n    return marked;\n  }\n\n  async loadContent(specialty, contentId, language = null) {\n    // Use current language if not specified\n    const lang = language || window.currentLanguage || 'en';\n    \n    // Map Spanish URLs to English content file names\n    const mappedContentId = this.mapContentId(specialty, contentId);\n    const cacheKey = `${lang}/${specialty}/${mappedContentId}`;\n    \n    // Return cached content if available\n    if (this.contentCache.has(cacheKey)) {\n      return this.contentCache.get(cacheKey);\n    }\n\n    try {\n      // Load content and metadata in parallel using mapped content ID\n      const [markdownContent, metadata] = await Promise.all([\n        this.loadMarkdownContent(specialty, mappedContentId, lang),\n        this.loadContentMetadata(specialty, mappedContentId, lang)\n      ]);\n\n      // Process and combine content\n      const processedContent = await this.processContent(markdownContent, metadata, lang);\n      \n      // Store original contentId for reference\n      processedContent.originalContentId = contentId;\n      processedContent.mappedContentId = mappedContentId;\n      \n      // Cache the result\n      this.contentCache.set(cacheKey, processedContent);\n      \n      return processedContent;\n      \n    } catch (error) {\n      console.error(`Failed to load content ${cacheKey}:`, error);\n      return this.createErrorContent(specialty, contentId, error, lang);\n    }\n  }\n\n  mapContentId(specialty, contentId) {\n    // Check if we have a mapping for this specialty and content ID\n    if (this.urlMappings[specialty] && this.urlMappings[specialty][contentId]) {\n      console.log(`Mapping ${specialty}/${contentId} -> ${this.urlMappings[specialty][contentId]}`);\n      return this.urlMappings[specialty][contentId];\n    }\n    \n    // If no mapping exists, return the original content ID\n    return contentId;\n  }\n\n  async loadMarkdownContent(specialty, contentId, language = 'en') {\n    // Get base path from Vite's import.meta.env.BASE_URL or detect from window location\n    const basePath = this.getBasePath();\n    const markdownPath = `${basePath}content/${language}/markdown/${specialty}/${contentId}.md`;\n    \n    console.log(`📄 Loading markdown from: ${markdownPath}`);\n    console.log(`🔍 Base path: \"${basePath}\"`);\n    console.log(`🔍 Specialty: \"${specialty}\", Content ID: \"${contentId}\", Language: \"${language}\"`);\n    \n    try {\n      const response = await fetch(markdownPath);\n      \n      console.log(`📄 Fetch response status: ${response.status} ${response.statusText}`);\n      \n      if (!response.ok) {\n        console.warn(`❌ Failed to fetch markdown: ${response.status} ${response.statusText} for ${markdownPath}`);\n        // If non-English content not found, try English fallback\n        if (language !== 'en') {\n          console.warn(`${language} content not found for ${specialty}/${contentId}, falling back to English`);\n          return this.loadMarkdownContent(specialty, contentId, 'en');\n        }\n        throw new Error(`Markdown not found: ${markdownPath} (${response.status} ${response.statusText})`);\n      }\n      \n      const text = await response.text();\n      console.log(`✅ Successfully loaded markdown content (${text.length} characters)`);\n      return text;\n      \n    } catch (error) {\n      console.error(`❌ Error loading markdown for ${specialty}/${contentId}:`, error);\n      console.warn(`Markdown content not found for ${specialty}/${contentId}, creating fallback`);\n      return this.createFallbackMarkdown(specialty, contentId, language);\n    }\n  }\n\n  async loadContentMetadata(specialty, contentId, language = 'en') {\n    // Get base path from Vite's import.meta.env.BASE_URL or detect from window location\n    const basePath = this.getBasePath();\n    const metadataPath = `${basePath}content/${language}/json/${specialty}/${contentId}.json`;\n    const cacheKey = `metadata-${language}-${specialty}/${contentId}`;\n    \n    console.log(`📊 Loading metadata from: ${metadataPath}`);\n    \n    // Return cached metadata if available\n    if (this.metadataCache.has(cacheKey)) {\n      console.log(`💾 Using cached metadata for ${cacheKey}`);\n      return this.metadataCache.get(cacheKey);\n    }\n\n    try {\n      const response = await fetch(metadataPath);\n      \n      console.log(`📊 Metadata fetch response status: ${response.status} ${response.statusText}`);\n      \n      if (!response.ok) {\n        console.warn(`❌ Failed to fetch metadata: ${response.status} ${response.statusText} for ${metadataPath}`);\n        // If non-English metadata not found, try English fallback\n        if (language !== 'en') {\n          console.warn(`${language} metadata not found for ${specialty}/${contentId}, falling back to English`);\n          return this.loadContentMetadata(specialty, contentId, 'en');\n        }\n        throw new Error(`Metadata not found: ${metadataPath} (${response.status} ${response.statusText})`);\n      }\n      \n      const metadata = await response.json();\n      \n      // Add language and translation status information\n      metadata.language = language;\n      metadata.translationStatus = await this.getTranslationStatus(specialty, contentId, language);\n      \n      // Cache metadata\n      this.metadataCache.set(cacheKey, metadata);\n      \n      return metadata;\n      \n    } catch (error) {\n      console.warn(`Metadata not found for ${specialty}/${contentId}, using defaults`);\n      return this.createDefaultMetadata(specialty, contentId, language);\n    }\n  }\n\n  async processContent(markdownContent, metadata, language = 'en') {\n    // Parse frontmatter if present\n    const { content, frontmatter } = this.parseFrontmatter(markdownContent);\n    \n    // Merge frontmatter with JSON metadata (JSON takes precedence)\n    const combinedMetadata = { ...frontmatter, ...metadata };\n    \n    // Convert markdown to HTML\n    const htmlContent = this.markedRenderer.parse(content);\n    \n    // Sanitize HTML for security\n    const sanitizedContent = DOMPurify.sanitize(htmlContent, {\n      ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'br', 'strong', 'em', 'u', 'ul', 'ol', 'li', 'a', 'table', 'thead', 'tbody', 'tr', 'th', 'td', 'blockquote', 'code', 'pre', 'div', 'span', 'mark'],\n      ALLOWED_ATTR: ['href', 'title', 'class', 'id', 'target', 'rel']\n    });\n    \n    // Add medical indicators if present\n    const enhancedContent = this.addMedicalIndicators(sanitizedContent, combinedMetadata);\n    \n    return {\n      content: enhancedContent,\n      metadata: combinedMetadata,\n      rawMarkdown: content,\n      lastModified: new Date().toISOString()\n    };\n  }\n\n  parseFrontmatter(markdownContent) {\n    const frontmatterRegex = /^---\\s*\\n([\\s\\S]*?)\\n---\\s*\\n([\\s\\S]*)$/;\n    const match = markdownContent.match(frontmatterRegex);\n    \n    if (!match) {\n      return { content: markdownContent, frontmatter: {} };\n    }\n    \n    try {\n      // Simple YAML-like parser for frontmatter\n      const frontmatterText = match[1];\n      const content = match[2];\n      const frontmatter = {};\n      \n      frontmatterText.split('\\n').forEach(line => {\n        const colonIndex = line.indexOf(':');\n        if (colonIndex > 0) {\n          const key = line.substring(0, colonIndex).trim();\n          let value = line.substring(colonIndex + 1).trim();\n          \n          // Remove quotes if present\n          if ((value.startsWith('\"') && value.endsWith('\"')) || \n              (value.startsWith(\"'\") && value.endsWith(\"'\"))) {\n            value = value.slice(1, -1);\n          }\n          \n          // Parse arrays\n          if (value.startsWith('[') && value.endsWith(']')) {\n            try {\n              value = JSON.parse(value);\n            } catch (e) {\n              // Keep as string if JSON parsing fails\n            }\n          }\n          \n          frontmatter[key] = value;\n        }\n      });\n      \n      return { content, frontmatter };\n      \n    } catch (error) {\n      console.warn('Failed to parse frontmatter:', error);\n      return { content: markdownContent, frontmatter: {} };\n    }\n  }\n\n  addMedicalIndicators(htmlContent, metadata) {\n    if (!metadata.frequency && !metadata.mortality) {\n      return htmlContent;\n    }\n    \n    // Create medical indicators\n    const indicators = [];\n    \n    if (metadata.frequency) {\n      const freqSymbol = this.getFrequencySymbol(metadata.frequency);\n      indicators.push(`<span class=\"medical-indicator frequency-${metadata.frequency}\" title=\"Frequency of Consultation: ${metadata.frequency}\">${freqSymbol}</span>`);\n    }\n    \n    if (metadata.mortality) {\n      const mortSymbol = this.getMortalitySymbol(metadata.mortality);\n      indicators.push(`<span class=\"medical-indicator mortality-${metadata.mortality}\" title=\"Mortality Risk: ${metadata.mortality}\">${mortSymbol}</span>`);\n    }\n    \n    if (indicators.length > 0) {\n      const indicatorHTML = `<div class=\"medical-indicators\">${indicators.join(' ')}</div>`;\n      // Insert indicators after the first heading\n      return htmlContent.replace(/(<h[1-6][^>]*>.*?<\\/h[1-6]>)/, `$1${indicatorHTML}`);\n    }\n    \n    return htmlContent;\n  }\n\n  getFrequencySymbol(frequency) {\n    const symbols = {\n      high: 'F█',\n      medium: 'F▄',\n      low: 'F▂'\n    };\n    return symbols[frequency] || 'F?';\n  }\n\n  getMortalitySymbol(mortality) {\n    const symbols = {\n      high: 'M█',\n      medium: 'M▄',\n      low: 'M▂'\n    };\n    return symbols[mortality] || 'M?';\n  }\n\n  createFallbackMarkdown(specialty, contentId) {\n    return `# ${contentId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n\nThis is a placeholder for ${specialty} content: ${contentId}.\n\nContent will be loaded from the hybrid CMS when available.\n\n## Clinical Information\n- **Specialty**: ${specialty}\n- **Content ID**: ${contentId}\n- **Status**: Content pending\n\n## Next Steps\n1. Create markdown content file: \\`content/markdown/${specialty}/${contentId}.md\\`\n2. Add metadata file: \\`content/json/${specialty}/${contentId}.json\\`\n3. Update navigation and search data\n`;\n  }\n\n  createDefaultMetadata(specialty, contentId) {\n    return {\n      title: contentId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase()),\n      specialty: specialty,\n      contentId: contentId,\n      setting: 'outpatient',\n      frequency: null,\n      mortality: null,\n      keywords: [specialty, contentId],\n      description: `Medical content for ${specialty}: ${contentId}`,\n      lastUpdated: new Date().toISOString(),\n      author: 'JP Silva',\n      status: 'draft'\n    };\n  }\n\n  createErrorContent(specialty, contentId, error) {\n    return {\n      content: `\n        <div class=\"error-content\">\n          <h2>Content Loading Error</h2>\n          <p>Failed to load content for <strong>${specialty}/${contentId}</strong></p>\n          <p class=\"error-details\">Error: ${error.message}</p>\n          <p><a href=\"/\">← Return to Home</a></p>\n        </div>\n      `,\n      metadata: this.createDefaultMetadata(specialty, contentId),\n      rawMarkdown: '',\n      lastModified: new Date().toISOString(),\n      error: true\n    };\n  }\n\n  // Index content for search and navigation\n  async indexContent(specialty, contentId, content) {\n    const indexKey = `${specialty}/${contentId}`;\n    \n    const searchData = {\n      title: content.metadata.title,\n      url: `/specialty/${specialty}/${contentId}`,\n      description: content.metadata.description,\n      keywords: Array.isArray(content.metadata.keywords) ? \n        content.metadata.keywords.join(', ') : \n        content.metadata.keywords || '',\n      specialty: specialty,\n      setting: content.metadata.setting,\n      frequency: content.metadata.frequency,\n      mortality: content.metadata.mortality\n    };\n    \n    this.contentIndex.set(indexKey, searchData);\n    \n    return searchData;\n  }\n\n  // Get all indexed content for search\n  getAllIndexedContent() {\n    return Array.from(this.contentIndex.values());\n  }\n\n  // Get content by specialty\n  getContentBySpecialty(specialty) {\n    return Array.from(this.contentIndex.entries())\n      .filter(([key]) => key.startsWith(`${specialty}/`))\n      .map(([, value]) => value);\n  }\n\n  // Clear cache\n  clearCache(cacheType = 'all') {\n    switch (cacheType) {\n      case 'content':\n        this.contentCache.clear();\n        break;\n      case 'metadata':\n        this.metadataCache.clear();\n        break;\n      case 'index':\n        this.contentIndex.clear();\n        break;\n      case 'all':\n        this.contentCache.clear();\n        this.metadataCache.clear();\n        this.contentIndex.clear();\n        break;\n    }\n  }\n\n  // Get cache statistics\n  getCacheStats() {\n    return {\n      contentCache: this.contentCache.size,\n      metadataCache: this.metadataCache.size,\n      contentIndex: this.contentIndex.size,\n      totalCachedItems: this.contentCache.size + this.metadataCache.size + this.contentIndex.size\n    };\n  }\n\n  // New methods for bilingual content support\n\n  async getTranslationStatus(specialty, contentId, language) {\n    try {\n      const basePath = this.getBasePath();\n      const response = await fetch(`${basePath}content/translation/status/translation-status.json`);\n      if (!response.ok) return null;\n      \n      const statusData = await response.json();\n      const contentKey = `${specialty}/${contentId}`;\n      \n      if (statusData.contentStatus && statusData.contentStatus[contentKey]) {\n        const contentStatus = statusData.contentStatus[contentKey];\n        return contentStatus.languages[language] || null;\n      }\n      \n      return null;\n    } catch (error) {\n      console.warn('Failed to load translation status:', error);\n      return null;\n    }\n  }\n\n  createFallbackMarkdown(specialty, contentId, language = 'en') {\n    const translations = {\n      en: {\n        title: `${contentId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}`,\n        content: 'This content is currently being developed. Please check back soon.',\n        specialty: specialty.charAt(0).toUpperCase() + specialty.slice(1)\n      },\n      es: {\n        title: `${contentId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}`,\n        content: 'Este contenido está actualmente en desarrollo. Por favor, vuelva pronto.',\n        specialty: specialty === 'neurology' ? 'Neurología' : specialty === 'dermatology' ? 'Dermatología' : specialty\n      }\n    };\n\n    const trans = translations[language] || translations.en;\n    \n    return `---\ntitle: \"${trans.title}\"\nspecialty: \"${specialty}\"\nstatus: \"under-development\"\n---\n\n# ${trans.title}\n\n${trans.content}\n\n---\n\n*${trans.specialty} - Conduct Based Medicine*`;\n  }\n\n  createDefaultMetadata(specialty, contentId, language = 'en') {\n    return {\n      title: contentId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase()),\n      specialty: specialty,\n      contentId: contentId,\n      setting: \"outpatient\",\n      frequency: \"medium\",\n      mortality: \"low\",\n      keywords: [contentId.replace(/-/g, ' ')],\n      description: \"Content currently under development\",\n      author: \"System Generated\",\n      lastUpdated: new Date().toISOString().split('T')[0],\n      status: \"under-development\",\n      language: language,\n      translationStatus: {\n        status: \"pending\",\n        autoTranslated: false,\n        humanReviewRequired: true\n      }\n    };\n  }\n\n  createErrorContent(specialty, contentId, error, language = 'en') {\n    const translations = {\n      en: {\n        title: 'Content Loading Error',\n        message: 'Failed to load content. Please try again later.',\n        error: 'Error'\n      },\n      es: {\n        title: 'Error al Cargar Contenido',\n        message: 'No se pudo cargar el contenido. Por favor, inténtelo más tarde.',\n        error: 'Error'\n      }\n    };\n\n    const trans = translations[language] || translations.en;\n\n    return {\n      content: `<div class=\"error-content\">\n        <h2>${trans.title}</h2>\n        <p>${trans.message}</p>\n        <details>\n          <summary>${trans.error}</summary>\n          <pre>${error.message}</pre>\n        </details>\n      </div>`,\n      metadata: this.createDefaultMetadata(specialty, contentId, language),\n      error: true\n    };\n  }\n\n  // Language utilities\n  getAvailableLanguages(specialty, contentId) {\n    // This would check which language versions exist\n    // For now, return basic info\n    return ['en']; // Will be enhanced when we implement the full translation system\n  }\n\n  isContentTranslated(specialty, contentId, language) {\n    if (language === 'en') return true; // English is always available\n    // Check if translated content exists\n    return false; // Will be implemented with full translation system\n  }\n}","// Navigation data module that fetches JSON files from public directory\n// JSON files in public/ directory need to be fetched at runtime in Vite\n\n// Cache for navigation data to avoid repeated fetches\nconst navigationCache = new Map();\n\nexport function clearNavigationCache() {\n  console.log('🧹 Clearing navigation cache...');\n  navigationCache.clear();\n}\n\nexport async function getNavigationData(specialty, basePath = '') {\n  console.log(`📊 Getting navigation data for: ${specialty} with basePath: \"${basePath}\"`);\n  \n  // Create cache key that includes base path\n  const cacheKey = `${specialty}-${basePath}`;\n  \n  // Check cache first\n  if (navigationCache.has(cacheKey)) {\n    console.log(`✅ Using cached navigation data for ${specialty}`);\n    return navigationCache.get(cacheKey);\n  }\n  \n  try {\n    // Determine the correct file name\n    const fileName = specialty === 'index' || !specialty \n      ? 'navigation-menu-index.json' \n      : `navigation-menu-${specialty}.json`;\n    \n    const url = `${basePath}/assets/data/${fileName}`;\n    console.log(`🔍 Fetching navigation data from: ${url}`);\n    \n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`Failed to fetch navigation data: ${response.status} ${response.statusText}`);\n    }\n    \n    const data = await response.json();\n    \n    // Cache the data with the cache key\n    navigationCache.set(cacheKey, data);\n    \n    console.log(`✅ Successfully loaded navigation data for ${specialty}:`, data);\n    return data;\n    \n  } catch (error) {\n    console.error(`❌ Failed to load navigation data for ${specialty}:`, error);\n    throw error;\n  }\n}","// src/utils/interactive-app-manager.js - Manager for interactive medical applications\nexport class InteractiveAppManager {\n  constructor() {\n    this.loadedApps = new Map();\n    this.appRegistry = new Map();\n    this.modalContainer = null;\n    this.setupAppRegistry();\n  }\n\n  setupAppRegistry() {\n    // Register available interactive apps\n    this.appRegistry.set('midas-calculator', {\n      name: 'MIDAS Calculator',\n      specialty: 'neurology',\n      description: 'Migraine Disability Assessment Scale',\n      module: () => import('../apps/neurology/MidasCalculator.js'),\n      className: 'MidasCalculator'\n    });\n\n    this.appRegistry.set('easi-calculator', {\n      name: 'EASI Calculator',\n      specialty: 'dermatology',\n      description: 'Eczema Area and Severity Index',\n      module: () => import('../apps/dermatology/EASICalculator.js'),\n      className: 'EASICalculator'\n    });\n\n    // Placeholder registrations for future tools\n    this.appRegistry.set('headache-diary', {\n      name: 'Headache Diary',\n      specialty: 'neurology',\n      description: 'Track headache patterns and triggers',\n      module: null, // To be implemented\n      className: 'HeadacheDiary'\n    });\n\n    this.appRegistry.set('medication-tracker', {\n      name: 'Medication Tracker',\n      specialty: 'general',\n      description: 'Track medication usage and effectiveness',\n      module: null, // To be implemented\n      className: 'MedicationTracker'\n    });\n\n    this.appRegistry.set('scorad-assessment', {\n      name: 'SCORAD Assessment',\n      specialty: 'dermatology',\n      description: 'Scoring Atopic Dermatitis',\n      module: null, // To be implemented\n      className: 'SCORADAssessment'\n    });\n\n    this.appRegistry.set('treatment-selection-guide', {\n      name: 'Treatment Selection Guide',\n      specialty: 'dermatology',\n      description: 'Interactive treatment decision support',\n      module: null, // To be implemented\n      className: 'TreatmentSelectionGuide'\n    });\n  }\n\n  async launchApp(appId, options = {}) {\n    console.log(`🚀 Launching interactive app: ${appId}`);\n\n    const appConfig = this.appRegistry.get(appId);\n    if (!appConfig) {\n      throw new Error(`Unknown interactive app: ${appId}`);\n    }\n\n    // Check if app module is available\n    if (!appConfig.module) {\n      this.showComingSoonModal(appConfig);\n      return;\n    }\n\n    try {\n      // Create modal container\n      const modalId = `modal-${appId}-${Date.now()}`;\n      const containerId = `app-${appId}-${Date.now()}`;\n      \n      this.createModalContainer(modalId, containerId, appConfig);\n\n      // Dynamically import and instantiate the app\n      const module = await appConfig.module();\n      const AppClass = module[appConfig.className];\n      \n      if (!AppClass) {\n        throw new Error(`App class ${appConfig.className} not found in module`);\n      }\n\n      const appInstance = new AppClass(containerId);\n      \n      // Store reference\n      this.loadedApps.set(modalId, {\n        instance: appInstance,\n        appId,\n        modalId,\n        containerId\n      });\n\n      // Initialize the app\n      await appInstance.init();\n\n      // Setup modal event handlers\n      this.setupModalEventHandlers(modalId);\n\n      console.log(`✅ Interactive app launched successfully: ${appConfig.name}`);\n\n    } catch (error) {\n      console.error(`❌ Failed to launch app ${appId}:`, error);\n      this.showErrorModal(appConfig, error);\n    }\n  }\n\n  createModalContainer(modalId, containerId, appConfig) {\n    const modal = document.createElement('div');\n    modal.id = modalId;\n    modal.className = 'interactive-app-modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4';\n    \n    modal.innerHTML = `\n      <div class=\"modal-content bg-gray-900 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\n        <div class=\"modal-header bg-gray-800 px-6 py-4 border-b border-gray-700 flex justify-between items-center\">\n          <div>\n            <h3 class=\"text-xl font-semibold text-gray-100\">${appConfig.name}</h3>\n            <p class=\"text-sm text-gray-400\">${appConfig.description}</p>\n          </div>\n          <button class=\"modal-close-btn text-gray-400 hover:text-gray-200 text-2xl\">×</button>\n        </div>\n        <div class=\"modal-body overflow-auto\" style=\"max-height: calc(90vh - 120px);\">\n          <div id=\"${containerId}\" class=\"interactive-app-container p-6\"></div>\n        </div>\n      </div>\n    `;\n\n    document.body.appendChild(modal);\n    return modal;\n  }\n\n  setupModalEventHandlers(modalId) {\n    const modal = document.getElementById(modalId);\n    if (!modal) return;\n\n    const closeBtn = modal.querySelector('.modal-close-btn');\n    const appData = this.loadedApps.get(modalId);\n\n    // Close button handler\n    if (closeBtn) {\n      closeBtn.addEventListener('click', () => this.closeApp(modalId));\n    }\n\n    // Click outside to close\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        this.closeApp(modalId);\n      }\n    });\n\n    // Escape key to close\n    const escapeHandler = (e) => {\n      if (e.key === 'Escape') {\n        this.closeApp(modalId);\n        document.removeEventListener('keydown', escapeHandler);\n      }\n    };\n    document.addEventListener('keydown', escapeHandler);\n\n    // App close event handler\n    if (appData && appData.instance) {\n      const container = document.getElementById(appData.containerId);\n      if (container) {\n        container.addEventListener('app-close', () => this.closeApp(modalId));\n      }\n    }\n\n    // Store the escape handler for cleanup\n    if (appData) {\n      appData.escapeHandler = escapeHandler;\n    }\n  }\n\n  closeApp(modalId) {\n    const appData = this.loadedApps.get(modalId);\n    if (!appData) return;\n\n    console.log(`🔚 Closing interactive app: ${appData.appId}`);\n\n    // Cleanup app instance\n    if (appData.instance && typeof appData.instance.destroy === 'function') {\n      appData.instance.destroy();\n    }\n\n    // Remove event listeners\n    if (appData.escapeHandler) {\n      document.removeEventListener('keydown', appData.escapeHandler);\n    }\n\n    // Remove modal from DOM\n    const modal = document.getElementById(modalId);\n    if (modal) {\n      modal.remove();\n    }\n\n    // Remove from loaded apps\n    this.loadedApps.delete(modalId);\n  }\n\n  closeAllApps() {\n    const modalIds = Array.from(this.loadedApps.keys());\n    modalIds.forEach(modalId => this.closeApp(modalId));\n  }\n\n  showComingSoonModal(appConfig) {\n    const modal = document.createElement('div');\n    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';\n    \n    modal.innerHTML = `\n      <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg max-w-md mx-4\">\n        <h3 class=\"text-xl font-semibold mb-4 text-gray-100\">${appConfig.name}</h3>\n        <p class=\"text-gray-300 mb-4\">${appConfig.description}</p>\n        <div class=\"bg-blue-900 p-4 rounded mb-4\">\n          <p class=\"text-blue-200 text-sm\">\n            🚧 This interactive tool is currently under development and will be available in a future update.\n          </p>\n        </div>\n        <div class=\"flex gap-3\">\n          <button class=\"close-modal bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded transition-colors\">\n            Close\n          </button>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Close handlers\n    modal.querySelector('.close-modal').addEventListener('click', () => modal.remove());\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) modal.remove();\n    });\n\n    // Auto-remove after 3 seconds\n    setTimeout(() => {\n      if (modal.parentNode) modal.remove();\n    }, 3000);\n  }\n\n  showErrorModal(appConfig, error) {\n    const modal = document.createElement('div');\n    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';\n    \n    modal.innerHTML = `\n      <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg max-w-md mx-4\">\n        <h3 class=\"text-xl font-semibold mb-4 text-red-400\">Error Loading App</h3>\n        <p class=\"text-gray-300 mb-2\">Failed to load: <strong>${appConfig.name}</strong></p>\n        <p class=\"text-sm text-gray-400 mb-4\">${error.message}</p>\n        <button class=\"close-modal bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded transition-colors\">\n          Close\n        </button>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Close handlers\n    modal.querySelector('.close-modal').addEventListener('click', () => modal.remove());\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) modal.remove();\n    });\n  }\n\n  getAvailableApps(specialty = null) {\n    const apps = Array.from(this.appRegistry.entries()).map(([id, config]) => ({\n      id,\n      ...config,\n      available: Boolean(config.module)\n    }));\n\n    if (specialty) {\n      return apps.filter(app => app.specialty === specialty || app.specialty === 'general');\n    }\n\n    return apps;\n  }\n\n  getAppsBySpecialty() {\n    const appsBySpecialty = {};\n    \n    this.appRegistry.forEach((config, id) => {\n      const specialty = config.specialty;\n      if (!appsBySpecialty[specialty]) {\n        appsBySpecialty[specialty] = [];\n      }\n      appsBySpecialty[specialty].push({\n        id,\n        ...config,\n        available: Boolean(config.module)\n      });\n    });\n\n    return appsBySpecialty;\n  }\n\n  isAppLoaded(appId) {\n    return Array.from(this.loadedApps.values()).some(app => app.appId === appId);\n  }\n\n  getLoadedApps() {\n    return Array.from(this.loadedApps.values()).map(app => ({\n      modalId: app.modalId,\n      appId: app.appId,\n      containerId: app.containerId\n    }));\n  }\n\n  // Utility method to add CSS for interactive apps\n  addInteractiveAppStyles() {\n    if (document.getElementById('interactive-app-styles')) return;\n\n    const style = document.createElement('style');\n    style.id = 'interactive-app-styles';\n    style.textContent = `\n      .interactive-app {\n        font-family: inherit;\n        color: inherit;\n      }\n\n      .app-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: flex-start;\n        margin-bottom: 1.5rem;\n        padding-bottom: 1rem;\n        border-bottom: 1px solid #374151;\n      }\n\n      .app-title {\n        font-size: 1.25rem;\n        font-weight: 600;\n        color: #f3f4f6;\n        margin: 0;\n      }\n\n      .app-description {\n        font-size: 0.875rem;\n        color: #9ca3af;\n        margin: 0.5rem 0 0 0;\n      }\n\n      .app-controls {\n        display: flex;\n        gap: 0.5rem;\n      }\n\n      .app-controls button {\n        background: #374151;\n        border: 1px solid #4b5563;\n        color: #d1d5db;\n        width: 2rem;\n        height: 2rem;\n        border-radius: 0.25rem;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n\n      .app-controls button:hover {\n        background: #4b5563;\n        color: #f3f4f6;\n      }\n\n      .form-field {\n        margin-bottom: 1rem;\n      }\n\n      .form-label {\n        display: block;\n        font-size: 0.875rem;\n        font-weight: 500;\n        color: #d1d5db;\n        margin-bottom: 0.5rem;\n      }\n\n      .form-input, .form-select {\n        width: 100%;\n        padding: 0.5rem;\n        background: #374151;\n        border: 1px solid #4b5563;\n        border-radius: 0.375rem;\n        color: #f3f4f6;\n        font-size: 0.875rem;\n      }\n\n      .form-input:focus, .form-select:focus {\n        outline: none;\n        border-color: #0ea5e9;\n        box-shadow: 0 0 0 1px #0ea5e9;\n      }\n\n      .checkbox-field, .radio-group {\n        margin-bottom: 1rem;\n      }\n\n      .checkbox-label, .radio-label {\n        display: flex;\n        align-items: center;\n        gap: 0.5rem;\n        cursor: pointer;\n        color: #d1d5db;\n      }\n\n      .form-checkbox, .form-radio {\n        margin: 0;\n      }\n\n      .app-disclaimer {\n        text-align: center;\n        margin-top: 1rem;\n        padding-top: 1rem;\n        border-top: 1px solid #374151;\n      }\n    `;\n\n    document.head.appendChild(style);\n  }\n}\n\n// Create global instance\nif (typeof window !== 'undefined') {\n  window.interactiveAppManager = new InteractiveAppManager();\n  window.interactiveAppManager.addInteractiveAppStyles();\n}","// src/main.js - Main SPA entry point\nimport { Router } from './utils/router.js';\nimport { ComponentLoader } from './utils/component-loader.js';\nimport { LanguageManager } from './utils/language-manager.js';\nimport { SearchManager } from './utils/search-manager.js';\nimport { ContentManager } from './utils/content-manager.js';\nimport { getNavigationData, clearNavigationCache } from './utils/navigation-data.js';\nimport './utils/interactive-app-manager.js'; // This creates window.interactiveAppManager\n\nclass ConductMedicineApp {\n  constructor() {\n    this.router = new Router();\n    this.componentLoader = new ComponentLoader();\n    this.languageManager = new LanguageManager();\n    this.searchManager = new SearchManager();\n    this.contentManager = new ContentManager();\n    this.isInitialized = false;\n    this.currentSpecialty = null; // Track current specialty for language switching\n    \n    // Detect and store base path at startup\n    this.basePath = this.detectBasePath();\n    console.log(`🔍 App initialized with basePath: \"${this.basePath}\"`);\n  }\n  \n  detectBasePath() {\n    // Detect base path from initial URL\n    const fullPath = window.location.pathname;\n    const href = window.location.href;\n    \n    console.log(`🔍 Detecting base path from pathname: \"${fullPath}\", href: \"${href}\"`);\n    \n    if (fullPath.includes('/conduct_medicine/') || href.includes('/conduct_medicine/')) {\n      return '/conduct_medicine';\n    }\n    return '';\n  }\n\n  async init() {\n    if (this.isInitialized) return;\n    \n    console.log('🏥 Initializing Conduct Based Medicine SPA...');\n    \n    try {\n      // Load core components that persist across navigation\n      await this.loadPersistentComponents();\n      \n      // Initialize language system\n      await this.languageManager.init();\n      \n      // Setup search functionality\n      await this.searchManager.init();\n      \n      // Initialize routing\n      this.setupRouting();\n      \n      // Initialize UI interactions\n      this.initializeInteractions();\n      \n      // Handle initial route AFTER components are loaded\n      await this.router.handleRoute();\n      \n      this.isInitialized = true;\n      console.log('✅ SPA initialization complete');\n      \n      // Add debugging helpers\n      window.debugConductMedicine = {\n        clearNavigationCache: () => {\n          clearNavigationCache();\n          console.log('Navigation cache cleared. Reload a specialty page to see updates.');\n        },\n        reloadCurrentSpecialty: () => {\n          if (this.currentSpecialty) {\n            clearNavigationCache();\n            this.loadSpecialtyNavigation(this.currentSpecialty);\n          } else {\n            console.log('No current specialty to reload.');\n          }\n        },\n        forceRefreshNavigation: () => {\n          clearNavigationCache();\n          // Add cache busting parameter\n          const originalFetch = window.fetch;\n          window.fetch = (url, options) => {\n            if (url.includes('navigation-menu-')) {\n              const cacheBuster = '?t=' + Date.now();\n              url = url + cacheBuster;\n            }\n            return originalFetch(url, options);\n          };\n          \n          if (this.currentSpecialty) {\n            this.loadSpecialtyNavigation(this.currentSpecialty);\n          }\n          console.log('🔄 Force refreshed navigation with cache busting');\n        }\n      };\n      \n    } catch (error) {\n      console.error('❌ Failed to initialize application:', error);\n      this.showErrorMessage('Failed to load application. Please refresh the page.');\n    }\n  }\n\n  async loadPersistentComponents() {\n    console.log('Loading persistent components...');\n    \n    // Load header with search and language switcher\n    const headerHTML = await this.componentLoader.loadPartial('partials/_header.html');\n    const headerPlaceholder = document.getElementById('header-placeholder');\n    if (headerPlaceholder && headerHTML) {\n      headerPlaceholder.outerHTML = headerHTML;\n    }\n\n    // Load navigation shell (will be populated by specialty-specific content)\n    const navHTML = await this.componentLoader.loadPartial('partials/_navigation_shell.html');\n    const navPlaceholder = document.getElementById('navigation-shell-placeholder');\n    if (navPlaceholder && navHTML) {\n      navPlaceholder.outerHTML = navHTML;\n    }\n\n    // Load footer\n    const footerHTML = await this.componentLoader.loadPartial('partials/_footer.html');\n    const footerPlaceholder = document.getElementById('footer-placeholder');\n    if (footerPlaceholder && footerHTML) {\n      footerPlaceholder.outerHTML = footerHTML;\n    }\n\n    // Load page overlay for modals\n    const overlayHTML = await this.componentLoader.loadPartial('partials/_page_overlay.html');\n    const overlayPlaceholder = document.getElementById('page-overlay-placeholder');\n    if (overlayPlaceholder && overlayHTML) {\n      overlayPlaceholder.outerHTML = overlayHTML;\n    }\n\n    // Initialize Lucide icons after components are loaded\n    if (typeof lucide !== 'undefined') {\n      lucide.createIcons();\n    }\n  }\n\n  setupRouting() {\n    // Define route patterns\n    this.router.addRoute('/', async () => await this.loadMainPage());\n    this.router.addRoute('/specialty/:specialty', async (params) => await this.loadSpecialtyPage(params.specialty));\n    this.router.addRoute('/specialty/:specialty/:page', async (params) => await this.loadSpecialtyContent(params.specialty, params.page));\n    this.router.addRoute('/tools/:tool', async (params) => await this.loadInteractiveTool(params.tool));\n    \n    // Handle browser navigation\n    window.addEventListener('popstate', async () => await this.router.handleRoute());\n    \n    // Handle internal navigation clicks\n    document.addEventListener('click', (e) => {\n      const link = e.target.closest('a[href]');\n      // Skip modal triggers, navigation category titles, and other special links\n      if (link && \n          link.id !== 'nav-link-invite-coffee' && \n          !link.closest('[data-modal=\"support\"]') && \n          !e.target.closest('.nav-category-title') &&\n          this.shouldHandleInternally(link.href)) {\n        e.preventDefault();\n        this.router.navigate(link.getAttribute('href'));\n      }\n    });\n  }\n\n  shouldHandleInternally(href) {\n    // Handle internal links, but let external links and anchors work normally\n    const url = new URL(href, window.location.origin);\n    return url.origin === window.location.origin && \n           !href.startsWith('#') && \n           !href.startsWith('mailto:') && \n           !href.startsWith('tel:');\n  }\n\n  async loadMainPage() {\n    console.log('Loading main page...');\n    \n    // Clear current specialty since we're on the main page\n    this.currentSpecialty = null;\n    \n    // Clear any existing navigation state flags to ensure fresh load\n    delete window.generalNavInitialized;\n    delete window.neurologyNavInitialized;\n    delete window.dermatologyNavInitialized;\n    \n    // The main page content is already in the HTML from index.html\n    // Don't replace it - just make sure it's visible and properly styled\n    const mainContent = document.querySelector('.actual-main-content');\n    if (mainContent && !mainContent.innerHTML.includes('Medical Specialties')) {\n      // Only replace content if the original content isn't there\n      console.log('Loading fallback main page content...');\n      // Keep the original content structure from index.html but with all specialties\n      mainContent.innerHTML = `\n        <h2 id=\"main-content-header\" class=\"text-2xl font-semibold mb-4 text-gray-100\">\n          Welcome to Conduct Based Medicine\n        </h2>\n        <p class=\"mb-4\">\n          Advanced medical education platform with evidence-based clinical decision support for healthcare professionals. \n          Features interactive tools, presentations, and comprehensive specialty content organized by clinical settings.\n        </p>\n        <p class=\"mb-4\">\n          Navigate using the menu on the left or explore our medical specialties below.\n        </p>\n        \n        <!-- Medical Specialties Grid -->\n        <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg mb-6\">\n          <h3 class=\"text-xl font-semibold mb-4 text-sky-400\">\n            Medical Specialties\n          </h3>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4\">\n            <a href=\"/specialty/neurology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🧠 Neurology</h4>\n              <p class=\"text-sm text-gray-300\">Neurological disorders and brain-related conditions</p>\n            </a>\n            <a href=\"/specialty/dermatology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🧴 Dermatology</h4>\n              <p class=\"text-sm text-gray-300\">Skin conditions and dermatologic diseases</p>\n            </a>\n            <a href=\"/specialty/cardiology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🫀 Cardiology</h4>\n              <p class=\"text-sm text-gray-300\">Cardiovascular diseases and heart conditions</p>\n            </a>\n            <a href=\"/specialty/internal_medicine\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🏥 Internal Medicine</h4>\n              <p class=\"text-sm text-gray-300\">Comprehensive adult medical care</p>\n            </a>\n            <a href=\"/specialty/gastroenterology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🫀 Gastroenterology</h4>\n              <p class=\"text-sm text-gray-300\">Digestive system and liver diseases</p>\n            </a>\n            <a href=\"/specialty/pulmonology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🫁 Pulmonology</h4>\n              <p class=\"text-sm text-gray-300\">Respiratory diseases and lung conditions</p>\n            </a>\n            <a href=\"/specialty/endocrinology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🧬 Endocrinology</h4>\n              <p class=\"text-sm text-gray-300\">Hormone disorders and metabolic conditions</p>\n            </a>\n            <a href=\"/specialty/nephrology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🫘 Nephrology</h4>\n              <p class=\"text-sm text-gray-300\">Kidney diseases and renal disorders</p>\n            </a>\n            <a href=\"/specialty/hematology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🩸 Hematology</h4>\n              <p class=\"text-sm text-gray-300\">Blood disorders and hematologic conditions</p>\n            </a>\n            <a href=\"/specialty/rheumatology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🦴 Rheumatology</h4>\n              <p class=\"text-sm text-gray-300\">Autoimmune and joint diseases</p>\n            </a>\n            <a href=\"/specialty/infectious_disease\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🦠 Infectious Disease</h4>\n              <p class=\"text-sm text-gray-300\">Infectious diseases and antimicrobial therapy</p>\n            </a>\n            <a href=\"/specialty/psychiatry\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🧠 Psychiatry</h4>\n              <p class=\"text-sm text-gray-300\">Mental health and psychiatric disorders</p>\n            </a>\n            <a href=\"/specialty/allergy_immunology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🤧 Allergy & Immunology</h4>\n              <p class=\"text-sm text-gray-300\">Allergic diseases and immune disorders</p>\n            </a>\n            <a href=\"/specialty/gynecology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">👩 Gynecology</h4>\n              <p class=\"text-sm text-gray-300\">Women's reproductive health</p>\n            </a>\n            <a href=\"/specialty/urology\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🫘 Urology</h4>\n              <p class=\"text-sm text-gray-300\">Urologic conditions and male health</p>\n            </a>\n            <a href=\"/specialty/pediatrics\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">👶 Pediatrics</h4>\n              <p class=\"text-sm text-gray-300\">Children's health and pediatric medicine</p>\n            </a>\n            <a href=\"/specialty/physical_medicine\" class=\"specialty-card bg-gray-700 p-4 rounded-lg hover:bg-gray-600 transition-colors\">\n              <h4 class=\"font-semibold text-blue-400 mb-2\">🏃 Physical Medicine & Rehabilitation</h4>\n              <p class=\"text-sm text-gray-300\">Rehabilitation and functional medicine</p>\n            </a>\n          </div>\n        </div>\n        \n        <!-- Clinical Organization -->\n        <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg\">\n          <h3 class=\"text-xl font-semibold mb-3 text-sky-400\">\n            Evidence-Based Clinical Organization\n          </h3>\n          <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div class=\"bg-gray-700 p-4 rounded-lg\">\n              <h4 class=\"font-semibold text-green-400 mb-2\">🏥 Outpatient Setting</h4>\n              <p class=\"text-sm text-gray-300\">Routine care, screening, preventive medicine, and chronic condition management</p>\n            </div>\n            <div class=\"bg-gray-700 p-4 rounded-lg\">\n              <h4 class=\"font-semibold text-yellow-400 mb-2\">🚨 Emergency Room</h4>\n              <p class=\"text-sm text-gray-300\">Acute presentations, urgent conditions, and emergency medical care</p>\n            </div>\n            <div class=\"bg-gray-700 p-4 rounded-lg\">\n              <h4 class=\"font-semibold text-red-400 mb-2\">🏨 Hospitalization</h4>\n              <p class=\"text-sm text-gray-300\">Complex cases, inpatient management, and specialized medical care</p>\n            </div>\n          </div>\n          <div class=\"mt-4 p-4 bg-gray-700 rounded-lg\">\n            <h4 class=\"font-semibold text-sky-400 mb-2\">📊 Frequency & Mortality Indicators</h4>\n            <p class=\"text-sm text-gray-300 mb-2\">Each condition includes evidence-based indicators:</p>\n            <div class=\"flex flex-wrap gap-4 text-xs\">\n              <span class=\"text-gray-400\"><strong>F█/F▄/F▂</strong> Consultation Frequency (High/Medium/Low)</span>\n              <span class=\"text-gray-400\"><strong>M█/M▄/M▂</strong> Mortality Risk (High/Medium/Low)</span>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n    \n    // Clear navigation panel before loading general navigation\n    const navPanel = document.querySelector('.site-navigation-panel');\n    if (navPanel) {\n      console.log('🔄 Clearing navigation panel for home page');\n      navPanel.innerHTML = '<div class=\"loading-nav\">Loading navigation...</div>';\n    } else {\n      console.warn('⚠️ Navigation panel not found when trying to clear it');\n    }\n    \n    // Load general navigation (not specialty-specific)\n    await this.loadGeneralNavigation();\n    \n    // Load main page presentation if available\n    this.loadMainPresentation();\n  }\n\n  async loadSpecialtyPage(specialty) {\n    console.log(`Loading ${specialty} specialty page...`);\n    \n    // Track current specialty for language switching\n    this.currentSpecialty = specialty;\n    \n    // Load specialty-specific navigation\n    await this.loadSpecialtyNavigation(specialty);\n    \n    // Load specialty main content\n    const mainContent = document.querySelector('.actual-main-content');\n    if (mainContent) {\n      mainContent.innerHTML = `\n        <h2 id=\"main-content-header\" class=\"text-2xl font-semibold mb-4 text-gray-100\">\n          Welcome to ${specialty.charAt(0).toUpperCase() + specialty.slice(1)}\n        </h2>\n        <p class=\"mb-4\">\n          Comprehensive ${specialty} conditions organized by clinical setting and frequency.\n        </p>\n        <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg\">\n          <h3 class=\"text-xl font-semibold mb-3 text-sky-400\">\n            Clinical Settings\n          </h3>\n          <div class=\"grid md:grid-cols-3 gap-4\">\n            <div class=\"bg-gray-700 p-4 rounded\">\n              <h4 class=\"font-semibold mb-2\">Outpatient</h4>\n              <p class=\"text-sm text-gray-300\">Common conditions seen in clinical practice.</p>\n            </div>\n            <div class=\"bg-gray-700 p-4 rounded\">\n              <h4 class=\"font-semibold mb-2\">Emergency Room</h4>\n              <p class=\"text-sm text-gray-300\">Acute presentations requiring immediate care.</p>\n            </div>\n            <div class=\"bg-gray-700 p-4 rounded\">\n              <h4 class=\"font-semibold mb-2\">Hospitalization</h4>\n              <p class=\"text-sm text-gray-300\">Complex cases requiring inpatient management.</p>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n    \n    // Load specialty presentation\n    this.loadSpecialtyPresentation(specialty);\n  }\n\n  async loadSpecialtyNavigation(specialty) {\n    console.log(`🧠 Loading ${specialty} navigation directly...`);\n    \n    try {\n      // Wait for navigation panel to be available (with retry)\n      let navPanel = document.querySelector('.site-navigation-panel');\n      let retries = 0;\n      const maxRetries = 10;\n      \n      while (!navPanel && retries < maxRetries) {\n        console.log(`⏳ Waiting for navigation panel... (attempt ${retries + 1}/${maxRetries})`);\n        await new Promise(resolve => setTimeout(resolve, 100)); // Wait 100ms\n        navPanel = document.querySelector('.site-navigation-panel');\n        retries++;\n      }\n      \n      if (!navPanel) {\n        console.error('❌ Navigation panel not found after retries');\n        console.log('🔍 Available elements:', document.querySelectorAll('[class*=\"nav\"]'));\n        return;\n      }\n      \n      console.log('✅ Navigation panel found:', navPanel);\n\n      // Use the base path detected at app startup\n      const basePath = this.basePath;\n      \n      const navDataUrl = `${basePath}/assets/data/navigation-menu-${specialty}.json`;\n      \n      console.log(`🔍 Loading ${specialty} navigation with basePath: \"${basePath}\"`);\n      \n      console.log(`📍 Loading navigation data for: ${specialty}`);\n      \n      // Fetch navigation data\n      const navData = await getNavigationData(specialty, basePath);\n      const lang = window.currentLanguage || 'en';\n      const uiStrings = (navData.ui_strings && navData.ui_strings[lang]) || navData.ui_strings?.en || {};\n\n      if (!Array.isArray(navData.sections) || navData.sections.length === 0) {\n        throw new Error('Invalid navigation data');\n      }\n\n      console.log(`🧠 Building ${specialty} navigation...`);\n      let navHtml = '';\n      \n      navData.sections.forEach(section => {\n        let titleTextHtml = '';\n        let sectionTitleForId = section.id;\n\n        if (section.title) {\n          const sectionTitleObj = section.title;\n          const sectionTitleText = sectionTitleObj[lang] || sectionTitleObj.en || '';\n          \n          if (!sectionTitleForId && sectionTitleObj.en) {\n            sectionTitleForId = this.generateSafeId(sectionTitleObj.en);\n          }\n\n          // Check for historical figure data in the section\n          if (section.historicalFigure) {\n            const figure = section.historicalFigure;\n            const altText = uiStrings.charcotImageAlt || figure.name;\n            const titleAttr = uiStrings.charcotImageTitle || `Learn more about ${figure.name}`;\n            \n            titleTextHtml = `\n              <span>${this.escapeHTML(sectionTitleText)}</span>\n              <a href=\"${figure.wikipediaUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"${this.escapeHTML(titleAttr)}\" class=\"inline-block ml-2\">\n                <img src=\"${figure.imageUrl}\" alt=\"${this.escapeHTML(altText)}\" class=\"w-8 h-8 rounded-full object-cover border border-gray-400 hover:border-sky-500 transition-all duration-200 ease-in-out align-middle\">\n              </a>\n            `;\n          } else {\n            titleTextHtml = this.escapeHTML(sectionTitleText);\n          }\n          navHtml += `<h3 id=\"${sectionTitleForId || this.generateSafeId('section-title')}\" class=\"mt-6 first:mt-0 flex items-center\">${titleTextHtml}</h3>`;\n        }\n\n        if (Array.isArray(section.items)) {\n          navHtml += `<ul>`;\n          section.items.forEach(item => {\n            const itemLabelObj = item.label;\n            const itemLabelText = itemLabelObj[lang] || itemLabelObj.en || '';\n            \n            let itemId = item.id;\n            if (!itemId && itemLabelObj.en) {\n              itemId = this.generateSafeId(itemLabelObj.en);\n            } else if (!itemId) {\n              itemId = this.generateSafeId('nav-item');\n            }\n            \n            if (item.subItems && item.subItems.length > 0) {\n              const subMenuId = `submenu-${itemId}`;\n              navHtml += `<li class=\"nav-category\">`;\n              navHtml += `<div class=\"nav-category-title\" role=\"button\" tabindex=\"0\" aria-expanded=\"false\" aria-controls=\"${subMenuId}\">\n                            <span>${this.escapeHTML(itemLabelText)}</span>\n                            <i data-lucide=\"chevron-right\" class=\"lucide-chevron-right\"></i>\n                          </div>`;\n              navHtml += `<ul id=\"${subMenuId}\">`;\n              item.subItems.forEach(subItem => {\n                const subItemLabelObj = subItem.label;\n                const subItemLabelText = subItemLabelObj[lang] || subItemLabelObj.en || '';\n                \n                let subItemId = subItem.id;\n                if(!subItemId && subItemLabelObj.en){\n                  subItemId = this.generateSafeId(subItemLabelObj.en);\n                } else if (!subItemId) {\n                  subItemId = this.generateSafeId('nav-subitem');\n                }\n                navHtml += `<li><a id=\"${subItemId}\" href=\"${this.escapeHTML(subItem.url)}\">${this.escapeHTML(subItemLabelText)}</a></li>`;\n              });\n              navHtml += `</ul>`;\n              navHtml += `</li>`;\n            } else {\n              navHtml += `<li><a id=\"${itemId}\" href=\"${this.escapeHTML(item.url)}\">${this.escapeHTML(itemLabelText)}</a></li>`;\n            }\n          });\n          navHtml += `</ul>`;\n        }\n      });\n\n      // Add legend\n      const legendHtmlString = `\n        <div class=\"nav-legend\">\n          <h4 class=\"text-sm font-semibold text-gray-200 mb-2\">${this.escapeHTML(uiStrings.legendTitle || \"Symbol Legend:\")}</h4>\n          <div class=\"legend-section mb-2\">\n            <p class=\"text-xs text-gray-400 mb-1\"><strong>FC</strong> (${this.escapeHTML(uiStrings.legendFC || \"Frequency of Consultation\")}):</p>\n            <ul class=\"text-xs text-gray-400\">\n              <li class=\"flex items-center mb-0.5\"><span class=\"symbol-legend-item\">F█</span> ${this.escapeHTML(uiStrings.legendHigh || \"High\")}</li>\n              <li class=\"flex items-center mb-0.5\"><span class=\"symbol-legend-item\">F▄</span> ${this.escapeHTML(uiStrings.legendMedium || \"Medium\")}</li>\n              <li class=\"flex items-center\"><span class=\"symbol-legend-item\">F▂</span> ${this.escapeHTML(uiStrings.legendLow || \"Low\")}</li>\n            </ul>\n          </div>\n          <div class=\"legend-section\">\n            <p class=\"text-xs text-gray-400 mb-1\"><strong>MA</strong> (${this.escapeHTML(uiStrings.legendMA || \"Mortality Associated\")}):</p>\n            <ul class=\"text-xs text-gray-400\">\n              <li class=\"flex items-center mb-0.5\"><span class=\"symbol-legend-item\">M█</span> ${this.escapeHTML(uiStrings.legendHigh || \"High\")}</li>\n              <li class=\"flex items-center mb-0.5\"><span class=\"symbol-legend-item\">M▄</span> ${this.escapeHTML(uiStrings.legendMedium || \"Medium\")}</li>\n              <li class=\"flex items-center\"><span class=\"symbol-legend-item\">M▂</span> ${this.escapeHTML(uiStrings.legendLow || \"Low\")}</li>\n            </ul>\n          </div>\n          <p class=\"text-xs text-gray-500 italic mt-2\">${this.escapeHTML(uiStrings.legendIndicators || \"(Indicators appear if data is available)\")}</p>\n        </div>\n      `;\n      navHtml += legendHtmlString;\n\n      console.log(`🧠 Setting navigation HTML for ${specialty}, length:`, navHtml.length);\n      navPanel.innerHTML = navHtml;\n\n      // Re-create icons\n      if (typeof lucide !== 'undefined') {\n        lucide.createIcons({ context: navPanel });\n      }\n\n      // Attach event listeners\n      this.attachNavigationEventListeners(navPanel);\n      \n      // Check for expandable categories\n      const categoryTitles = navPanel.querySelectorAll('.nav-category-title');\n      console.log(`🧠 Found ${categoryTitles.length} expandable categories for ${specialty}`);\n      categoryTitles.forEach((title, index) => {\n        console.log(`🧠 Category ${index + 1}:`, title.textContent.trim());\n        \n        // Verify the structure for debugging\n        const categoryLi = title.closest('.nav-category');\n        const subMenu = title.nextElementSibling;\n        console.log(`   └── Structure check - categoryLi: ${!!categoryLi}, subMenu: ${!!subMenu}`);\n      });\n      \n      console.log(`✅ Successfully loaded ${specialty} navigation with ${categoryTitles.length} expandable sections`);\n      \n    } catch (error) {\n      console.error(`❌ Failed to load ${specialty} navigation:`, error);\n      this.createBasicNavigation();\n    }\n  }\n\n  async loadGeneralNavigation() {\n    try {\n      // Build navigation directly without relying on external scripts that might be overwritten\n      const navPanel = document.querySelector('.site-navigation-panel');\n      if (!navPanel) {\n        console.warn('Navigation panel not found');\n        this.createBasicNavigation();\n        return;\n      }\n      \n      // Clear navigation panel first\n      navPanel.innerHTML = '<div class=\"loading-nav\">Loading navigation...</div>';\n      \n      // Use the base path detected at app startup\n      const basePath = this.basePath;\n      \n      const navDataUrl = `${basePath}/assets/data/navigation-menu-index.json`;\n      \n      console.log(`🔍 Loading general navigation with basePath: \"${basePath}\"`);\n      \n      // Fetch navigation data for index\n      const navData = await getNavigationData('index', basePath);\n      \n      // Handle different structures: index is array, specialties have sections property\n      const navStructure = Array.isArray(navData) ? navData : (navData.sections || []);\n      \n      if (!Array.isArray(navStructure) || navStructure.length === 0) {\n        throw new Error('Invalid navigation data');\n      }\n      \n      // Build navigation HTML with language support\n      const lang = window.currentLanguage || 'en';\n      let navHtml = '';\n      \n      navStructure.forEach(section => {\n        const sectionId = section.id || this.generateSafeId((typeof section.title === 'object' ? section.title.en : section.title));\n        const sectionTitle = (typeof section.title === 'object') ? \n          (section.title[lang] || section.title.en || '') : \n          section.title;\n        \n        navHtml += `<h3 id=\"${sectionId}\" class=\"mt-6 first:mt-0\">${this.escapeHTML(sectionTitle)}</h3><ul>`;\n        \n        if (Array.isArray(section.items)) {\n          section.items.forEach(item => {\n            const itemLabel = (typeof item.label === 'object') ? \n              (item.label[lang] || item.label.en || '') : \n              item.label;\n            \n            if (item.subItems && item.subItems.length > 0) {\n              const subMenuId = `submenu-${item.id || this.generateSafeId(itemLabel)}`;\n              navHtml += `<li class=\"nav-category\">`;\n              navHtml += `<div class=\"nav-category-title\" role=\"button\" tabindex=\"0\" aria-expanded=\"false\" aria-controls=\"${subMenuId}\">\n                            <span>${this.escapeHTML(itemLabel)}</span>\n                            <i data-lucide=\"chevron-right\" class=\"lucide-chevron-right\"></i>\n                          </div>`;\n              navHtml += `<ul id=\"${subMenuId}\">`;\n              item.subItems.forEach(subItem => {\n                const subItemLabel = (typeof subItem.label === 'object') ? \n                  (subItem.label[lang] || subItem.label.en || '') : \n                  subItem.label;\n                navHtml += `<li><a id=\"${subItem.id || ''}\" href=\"${this.escapeHTML(subItem.url)}\">${this.escapeHTML(subItemLabel)}</a></li>`;\n              });\n              navHtml += `</ul>`;\n              navHtml += `</li>`;\n            } else {\n              navHtml += `<li><a id=\"${item.id || ''}\" href=\"${this.escapeHTML(item.url)}\">${this.escapeHTML(itemLabel)}</a></li>`;\n            }\n          });\n        }\n        navHtml += `</ul>`;\n      });\n      \n      navPanel.innerHTML = navHtml;\n      \n      // Re-create icons\n      if (typeof lucide !== 'undefined') {\n        lucide.createIcons({ context: navPanel });\n      }\n      \n      // Add event listeners using event delegation on the navigation panel itself\n      this.attachNavigationEventListeners(navPanel);\n      \n    } catch (error) {\n      console.error('Error building navigation directly:', error);\n      this.createBasicNavigation();\n    }\n  }\n\n  attachNavigationEventListeners(navPanel) {\n    console.log('🔧 Attaching navigation event listeners to panel:', navPanel);\n    \n    // Remove any existing event listeners to prevent duplicates\n    if (this.handleNavigationClick) {\n      navPanel.removeEventListener('click', this.handleNavigationClick);\n    }\n    if (this.handleNavigationKeydown) {\n      navPanel.removeEventListener('keydown', this.handleNavigationKeydown);\n    }\n    \n    // Use event delegation on the navigation panel\n    this.handleNavigationClick = (event) => {\n      console.log('🖱️ Navigation panel clicked, target:', event.target);\n      const categoryTitle = event.target.closest('.nav-category-title');\n      if (categoryTitle) {\n        event.preventDefault();\n        event.stopPropagation();\n        console.log('✅ Found .nav-category-title element:', categoryTitle.textContent.trim());\n        this.toggleNavigationCategory(categoryTitle);\n      } else {\n        console.log('ℹ️ Click was not on a .nav-category-title element');\n      }\n    };\n    \n    this.handleNavigationKeydown = (event) => {\n      if (event.key === 'Enter' || event.key === ' ') {\n        const categoryTitle = event.target.closest('.nav-category-title');\n        if (categoryTitle) {\n          event.preventDefault();\n          console.log('⌨️ Keyboard activation on category:', categoryTitle.textContent.trim());\n          this.toggleNavigationCategory(categoryTitle);\n        }\n      }\n    };\n    \n    navPanel.addEventListener('click', this.handleNavigationClick);\n    navPanel.addEventListener('keydown', this.handleNavigationKeydown);\n    \n    console.log('✅ Navigation event listeners attached successfully');\n  }\n  \n  toggleNavigationCategory(titleElement) {\n    console.log('🔄 Toggling navigation category:', titleElement.textContent.trim());\n    \n    const categoryLi = titleElement.closest('.nav-category');\n    const subMenu = titleElement.nextElementSibling;\n    const icon = titleElement.querySelector('i[data-lucide]');\n    \n    console.log('🔍 Elements found - categoryLi:', categoryLi, 'subMenu:', subMenu, 'icon:', icon);\n    console.log('🔍 Title element HTML:', titleElement.outerHTML);\n    \n    if (!categoryLi || !subMenu) {\n      console.error('❌ Missing required elements for navigation toggle');\n      return;\n    }\n    \n    const isExpanded = titleElement.getAttribute('aria-expanded') === 'true';\n    console.log(`📋 Current state: ${isExpanded ? 'expanded' : 'collapsed'} → ${!isExpanded ? 'expanded' : 'collapsed'}`);\n    \n    categoryLi.classList.toggle('open');\n    titleElement.setAttribute('aria-expanded', String(!isExpanded));\n    \n    if (icon) {\n      const newIconName = isExpanded ? 'chevron-right' : 'chevron-down';\n      icon.innerHTML = '';\n      icon.setAttribute('data-lucide', newIconName);\n      console.log(`🔄 Icon changed to: ${newIconName}`);\n      \n      if (typeof lucide !== 'undefined') {\n        lucide.createIcons({ elements: [icon] });\n      } else {\n        console.warn('⚠️ Lucide icons not available');\n      }\n    } else {\n      console.warn('⚠️ No icon found to toggle');\n    }\n    \n    console.log('✅ Navigation category toggle completed');\n  }\n  \n  escapeHTML(str) {\n    if (typeof str !== 'string') return '';\n    return str.replace(/[&<>\"']/g, function (match) {\n      return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#39;' }[match];\n    });\n  }\n  \n  generateSafeId(label) {\n    if (typeof label !== 'string') return 'nav-item';\n    return label.toLowerCase().replace(/\\s+/g, '-').replace(/[^a-z0-9-]/g, '');\n  }\n\n  createBasicNavigation() {\n    const navPanel = document.querySelector('.site-navigation-panel');\n    if (!navPanel) return;\n\n    navPanel.innerHTML = `\n      <nav class=\"basic-navigation\">\n        <h3 class=\"text-lg font-semibold text-gray-200 mb-4\">Medical Specialties</h3>\n        <ul class=\"space-y-2\">\n          <li>\n            <a href=\"/specialty/neurology\" class=\"block p-2 text-gray-300 hover:bg-gray-700 hover:text-white rounded transition-colors\">\n              🧠 Neurology\n            </a>\n          </li>\n          <li>\n            <a href=\"/specialty/dermatology\" class=\"block p-2 text-gray-300 hover:bg-gray-700 hover:text-white rounded transition-colors\">\n              🩺 Dermatology\n            </a>\n          </li>\n        </ul>\n        \n        <div class=\"mt-8\">\n          <h4 class=\"text-sm font-semibold text-gray-300 mb-2\">Sample Content</h4>\n          <ul class=\"space-y-1 text-sm\">\n            <li>\n              <a href=\"/specialty/neurology/headache-management\" class=\"block p-1 text-gray-400 hover:text-sky-400 transition-colors\">\n                Headache Management\n              </a>\n            </li>\n            <li>\n              <a href=\"/specialty/dermatology/atopic-dermatitis\" class=\"block p-1 text-gray-400 hover:text-sky-400 transition-colors\">\n                Atopic Dermatitis\n              </a>\n            </li>\n          </ul>\n        </div>\n        \n        <div class=\"mt-8 p-3 bg-gray-800 rounded text-sm text-gray-400\">\n          <p>📝 Navigation system loading...</p>\n          <p>This is a basic fallback menu.</p>\n        </div>\n      </nav>\n    `;\n    \n    console.log('📋 Created basic navigation fallback');\n  }\n\n  loadMainPresentation() {\n    // Check if there's a presentation area and load it\n    const presentationWrapper = document.querySelector('.presentation-area-wrapper[data-presentation-src]');\n    if (presentationWrapper && typeof loadAndInitializeReveal === 'function') {\n      console.log('🎬 Loading main page presentation...');\n      loadAndInitializeReveal();\n    } else if (presentationWrapper) {\n      console.warn('⚠️ Presentation wrapper found but loadAndInitializeReveal function not available');\n    }\n  }\n\n  loadSpecialtyPresentation(specialty) {\n    // Don't reload presentation for specialty pages to avoid conflicts\n    console.log(`🎬 Skipping presentation reload for specialty: ${specialty}`);\n  }\n\n  async loadSpecialtyContent(specialty, page) {\n    console.log(`Loading ${specialty}/${page} content...`);\n    \n    // Track current specialty for language switching\n    this.currentSpecialty = specialty;\n    \n    // Load specialty navigation first (side pane)\n    await this.loadSpecialtyNavigation(specialty);\n    \n    const mainContent = document.querySelector('.actual-main-content');\n    if (!mainContent) return;\n    \n    // Show loading indicator\n    mainContent.innerHTML = `\n      <div class=\"loading-content\">\n        <h2 class=\"text-2xl font-semibold mb-4 text-gray-100\">Loading...</h2>\n        <p>Loading ${specialty} content: ${page}...</p>\n      </div>\n    `;\n    \n    try {\n      // Load content using the hybrid CMS with current language\n      const currentLanguage = window.currentLanguage || 'en';\n      const content = await this.contentManager.loadContent(specialty, page, currentLanguage);\n      \n      if (content.error) {\n        mainContent.innerHTML = content.content;\n        return;\n      }\n      \n      // Create content structure with metadata (optimized for side pane layout)\n      const contentHTML = `\n        <article class=\"medical-content-with-sidebar\">\n          <header class=\"content-header\">\n            <div class=\"breadcrumb text-sm text-gray-400 mb-2\">\n              <a href=\"/specialty/${specialty}\" class=\"hover:text-sky-400\">${specialty.charAt(0).toUpperCase() + specialty.slice(1)}</a>\n              <span class=\"mx-2\">›</span>\n              <span>${content.metadata.title}</span>\n            </div>\n            <h1 class=\"text-2xl font-bold mb-2 text-gray-100\">${content.metadata.title}</h1>\n            <div class=\"content-meta\">\n              <span class=\"specialty-tag\">${content.metadata.specialty}</span>\n              <span class=\"setting-tag\">${content.metadata.setting}</span>\n              ${content.metadata.frequency ? `<span class=\"frequency-indicator\">${this.contentManager.getFrequencySymbol(content.metadata.frequency)}</span>` : ''}\n              ${content.metadata.mortality ? `<span class=\"mortality-indicator\">${this.contentManager.getMortalitySymbol(content.metadata.mortality)}</span>` : ''}\n              ${this.generateLanguageIndicators(content.metadata, currentLanguage)}\n            </div>\n            ${content.metadata.lastUpdated ? `<p class=\"text-xs text-gray-400 mt-2\">Last updated: ${new Date(content.metadata.lastUpdated).toLocaleDateString()}</p>` : ''}\n            ${this.generateTranslationStatus(content.metadata)}\n          </header>\n          <div class=\"content-body\">\n            ${content.content}\n          </div>\n          ${content.metadata.interactiveTools && content.metadata.interactiveTools.length > 0 ? this.renderInteractiveTools(content.metadata.interactiveTools) : ''}\n          ${content.metadata.relatedContent && content.metadata.relatedContent.length > 0 ? this.renderRelatedContent(content.metadata.relatedContent, specialty) : ''}\n        </article>\n      `;\n      \n      mainContent.innerHTML = contentHTML;\n      \n      // Initialize any interactive components\n      this.initializeContentInteractions();\n      \n      // Index content for search\n      await this.contentManager.indexContent(specialty, page, content);\n      \n      // Update active navigation state\n      this.updateActiveNavigation(`/specialty/${specialty}/${page}`);\n      \n    } catch (error) {\n      console.error(`Failed to load ${specialty}/${page}:`, error);\n      mainContent.innerHTML = `\n        <div class=\"error-content\">\n          <h2 class=\"text-xl font-semibold mb-4 text-red-400\">Error Loading Content</h2>\n          <p>Failed to load ${specialty}: ${page}</p>\n          <p class=\"text-sm text-gray-400 mt-2\">${error.message}</p>\n          <a href=\"/specialty/${specialty}\" class=\"text-sky-400 hover:text-sky-300 mt-4 inline-block\">← Back to ${specialty}</a>\n        </div>\n      `;\n    }\n  }\n\n  updateActiveNavigation(currentPath) {\n    // Clear previous active states\n    document.querySelectorAll('.nav-link-active, .nav-category-active').forEach(el => {\n      el.classList.remove('nav-link-active', 'nav-category-active');\n    });\n\n    // Find and highlight current navigation item\n    const navLinks = document.querySelectorAll('.site-navigation-panel a[href]');\n    navLinks.forEach(link => {\n      const href = link.getAttribute('href');\n      if (href === currentPath || currentPath.endsWith(href)) {\n        link.classList.add('nav-link-active');\n        \n        // Also highlight parent categories\n        const parentCategory = link.closest('.nav-category');\n        if (parentCategory) {\n          parentCategory.classList.add('nav-category-active');\n          // Expand parent category if collapsed\n          const categoryTitle = parentCategory.querySelector('.nav-category-title');\n          if (categoryTitle) {\n            categoryTitle.setAttribute('aria-expanded', 'true');\n            parentCategory.classList.add('open');\n          }\n        }\n      }\n    });\n  }\n\n  renderInteractiveTools(tools) {\n    return `\n      <section class=\"interactive-tools mt-8\">\n        <h3 class=\"text-xl font-semibold mb-4 text-sky-400\">Interactive Tools</h3>\n        <div class=\"tools-grid grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          ${tools.map(tool => `\n            <div class=\"tool-card bg-gray-700 p-4 rounded-lg\">\n              <h4 class=\"font-semibold mb-2\">${tool.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}</h4>\n              <button class=\"launch-tool bg-sky-600 hover:bg-sky-700 text-white px-3 py-1 rounded text-sm\" data-tool=\"${tool}\">\n                Launch Tool\n              </button>\n            </div>\n          `).join('')}\n        </div>\n      </section>\n    `;\n  }\n\n  renderRelatedContent(relatedItems, specialty) {\n    return `\n      <section class=\"related-content mt-8\">\n        <h3 class=\"text-xl font-semibold mb-4 text-sky-400\">Related Content</h3>\n        <div class=\"related-links grid md:grid-cols-2 gap-3\">\n          ${relatedItems.map(item => `\n            <a href=\"/specialty/${specialty}/${item}\" class=\"related-link block p-3 bg-gray-700 rounded hover:bg-gray-600 transition-colors\">\n              ${item.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n            </a>\n          `).join('')}\n        </div>\n      </section>\n    `;\n  }\n\n  initializeContentInteractions() {\n    // Handle interactive tool launches\n    document.querySelectorAll('.launch-tool').forEach(button => {\n      button.addEventListener('click', (e) => {\n        const tool = e.target.getAttribute('data-tool');\n        this.launchInteractiveTool(tool);\n      });\n    });\n  }\n\n  async launchInteractiveTool(tool) {\n    console.log(`Launching interactive tool: ${tool}`);\n    \n    if (window.interactiveAppManager) {\n      try {\n        await window.interactiveAppManager.launchApp(tool);\n      } catch (error) {\n        console.error(`Failed to launch ${tool}:`, error);\n        this.showModal(`\n          <div class=\"tool-modal\">\n            <h3 class=\"text-xl font-semibold mb-4 text-red-400\">Error</h3>\n            <p>Failed to launch interactive tool: ${tool}</p>\n            <p class=\"text-sm text-gray-400 mt-2\">${error.message}</p>\n          </div>\n        `);\n      }\n    } else {\n      this.showModal(`\n        <div class=\"tool-modal\">\n          <h3 class=\"text-xl font-semibold mb-4\">Interactive Tool: ${tool}</h3>\n          <p>Interactive app manager not available.</p>\n        </div>\n      `);\n    }\n  }\n\n  showModal(content) {\n    const modal = document.createElement('div');\n    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';\n    modal.innerHTML = `\n      <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg max-w-2xl mx-4 max-h-[80vh] overflow-auto\">\n        ${content}\n        <button class=\"close-modal bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded mt-4\">\n          Close\n        </button>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Close handlers\n    modal.querySelector('.close-modal').addEventListener('click', () => modal.remove());\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) modal.remove();\n    });\n    \n    // Coffee button handler\n    modal.querySelector('.coffee-btn').addEventListener('click', () => {\n      // You can replace this URL with your actual donation platform\n      window.open('https://ko-fi.com/conductmedicine', '_blank');\n    });\n  }\n\n  async loadInteractiveTool(tool) {\n    console.log(`Loading interactive tool: ${tool}`);\n    // Placeholder for interactive tools\n    const mainContent = document.querySelector('.actual-main-content');\n    if (mainContent) {\n      mainContent.innerHTML = `\n        <h2 class=\"text-2xl font-semibold mb-4 text-gray-100\">Interactive Tool: ${tool}</h2>\n        <p>Interactive medical tool will be loaded here.</p>\n      `;\n    }\n  }\n\n  initializeInteractions() {\n    // Mobile navigation toggle\n    this.setupMobileNavigation();\n    \n    // Language switcher\n    this.setupLanguageSwitcher();\n    \n    // Search functionality\n    this.setupSearchInteractions();\n    \n    // Modal system\n    this.setupModalSystem();\n  }\n\n  setupMobileNavigation() {\n    const mobileToggle = document.getElementById('mobile-nav-toggle');\n    const navPanel = document.querySelector('.site-navigation-panel');\n    const overlay = document.getElementById('page-overlay');\n\n    if (mobileToggle && navPanel && overlay) {\n      mobileToggle.addEventListener('click', () => {\n        const isOpen = navPanel.classList.contains('mobile-nav-is-open');\n        \n        if (isOpen) {\n          navPanel.classList.remove('mobile-nav-is-open');\n          overlay.classList.remove('is-visible');\n          document.body.classList.remove('mobile-nav-active');\n        } else {\n          navPanel.classList.add('mobile-nav-is-open');\n          overlay.classList.add('is-visible');\n          document.body.classList.add('mobile-nav-active');\n        }\n      });\n\n      overlay.addEventListener('click', () => {\n        navPanel.classList.remove('mobile-nav-is-open');\n        overlay.classList.remove('is-visible');\n        document.body.classList.remove('mobile-nav-active');\n      });\n    }\n  }\n\n  setupLanguageSwitcher() {\n    const translateButton = document.getElementById('translate-button');\n    if (translateButton) {\n      translateButton.addEventListener('click', () => {\n        this.languageManager.toggleLanguage();\n      });\n    }\n  }\n\n  setupSearchInteractions() {\n    // Ctrl+K shortcut for search\n    document.addEventListener('keydown', (event) => {\n      if ((event.ctrlKey || event.metaKey) && event.key === 'k') {\n        event.preventDefault();\n        const searchInput = document.getElementById('search-input');\n        if (searchInput) {\n          searchInput.focus();\n          searchInput.select();\n        }\n      }\n    });\n  }\n\n  // Method called by language manager to reload navigation for language changes\n  async reloadCurrentSpecialtyNavigation() {\n    if (this.currentSpecialty) {\n      console.log(`🌍 Reloading ${this.currentSpecialty} navigation for language change`);\n      await this.loadSpecialtyNavigation(this.currentSpecialty);\n    } else {\n      console.log(`🌍 Reloading home page navigation for language change`);\n      await this.loadGeneralNavigation();\n    }\n  }\n\n  setupModalSystem() {\n    // Setup support/coffee modal trigger\n    document.addEventListener('click', (e) => {\n      const supportLink = e.target.closest('[data-modal=\"support\"]') || e.target.closest('#nav-link-invite-coffee');\n      if (supportLink) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.showSupportModal();\n      }\n    });\n  }\n\n  showSupportModal() {\n    // Create and show support modal\n    const modal = document.createElement('div');\n    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';\n    modal.innerHTML = `\n      <div class=\"bg-gray-800 p-6 rounded-lg shadow-lg max-w-md mx-4\">\n        <h3 class=\"text-xl font-semibold mb-4 text-gray-100\">Support Our Medical Education Platform</h3>\n        <p class=\"text-gray-300 mb-4\">Help us maintain and expand this clinical decision support tool.</p>\n        <div class=\"flex gap-3\">\n          <button class=\"coffee-btn bg-sky-600 hover:bg-sky-700 text-white px-4 py-2 rounded transition-colors\">\n            ☕ Buy me a coffee\n          </button>\n          <button class=\"close-modal bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded transition-colors\">\n            Close\n          </button>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Close handlers\n    modal.querySelector('.close-modal').addEventListener('click', () => modal.remove());\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        modal.remove();\n      }\n    });\n    \n    // Coffee button handler\n    modal.querySelector('.coffee-btn').addEventListener('click', () => {\n      // You can replace this URL with your actual donation platform\n      window.open('https://ko-fi.com/conductmedicine', '_blank');\n    });\n  }\n\n  showErrorMessage(message) {\n    const errorDiv = document.createElement('div');\n    errorDiv.className = 'fixed top-4 right-4 bg-red-600 text-white p-4 rounded shadow-lg z-50';\n    errorDiv.textContent = message;\n    document.body.appendChild(errorDiv);\n    \n    setTimeout(() => errorDiv.remove(), 5000);\n  }\n\n  // Translation status and language indicator methods\n  generateLanguageIndicators(metadata, currentLanguage) {\n    const availableLanguages = ['en', 'es']; // Will be enhanced to check actual availability\n    let indicators = '';\n\n    availableLanguages.forEach(lang => {\n      const isActive = lang === currentLanguage;\n      const flag = lang === 'en' ? '🇺🇸' : '🇪🇸';\n      const langName = lang === 'en' ? 'English' : 'Español';\n      \n      // Check if content exists for this language (simplified for now)\n      const hasContent = lang === 'en' || (metadata.translationStatus && metadata.translationStatus.status !== 'pending');\n      \n      if (hasContent) {\n        const className = isActive ? 'language-indicator active' : 'language-indicator';\n        const title = isActive ? `Currently viewing in ${langName}` : `Switch to ${langName}`;\n        indicators += `<span class=\"${className}\" title=\"${title}\" data-lang=\"${lang}\">${flag}</span>`;\n      } else {\n        indicators += `<span class=\"language-indicator unavailable\" title=\"Not available in ${langName}\">⚪</span>`;\n      }\n    });\n\n    return indicators;\n  }\n\n  generateTranslationStatus(metadata) {\n    if (!metadata.translationStatus || metadata.language === 'en') {\n      return '';\n    }\n\n    const status = metadata.translationStatus;\n    let statusHTML = '';\n\n    if (status.status === 'auto-translated') {\n      statusHTML = `\n        <div class=\"translation-status mt-2 p-2 bg-yellow-900/30 border border-yellow-600/50 rounded text-sm\">\n          <div class=\"flex items-center gap-2 text-yellow-400\">\n            <span>🤖</span>\n            <span>Auto-translated content</span>\n          </div>\n          <p class=\"text-xs text-yellow-300 mt-1\">\n            This content has been automatically translated and requires medical professional review.\n            Treatment protocols and dosages should be verified before clinical use.\n          </p>\n        </div>\n      `;\n    } else if (status.status === 'human-reviewed') {\n      statusHTML = `\n        <div class=\"translation-status mt-2 p-2 bg-green-900/30 border border-green-600/50 rounded text-sm\">\n          <div class=\"flex items-center gap-2 text-green-400\">\n            <span>✅</span>\n            <span>Medically reviewed translation</span>\n          </div>\n          <p class=\"text-xs text-green-300 mt-1\">\n            Reviewed by: ${status.reviewedBy || 'Medical professional'} on ${status.lastUpdated}\n          </p>\n        </div>\n      `;\n    } else if (status.status === 'pending') {\n      statusHTML = `\n        <div class=\"translation-status mt-2 p-2 bg-gray-900/30 border border-gray-600/50 rounded text-sm\">\n          <div class=\"flex items-center gap-2 text-gray-400\">\n            <span>⏳</span>\n            <span>Translation in progress</span>\n          </div>\n        </div>\n      `;\n    }\n\n    return statusHTML;\n  }\n}\n\n// Initialize the application when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => {\n    window.app = new ConductMedicineApp();\n    window.app.init();\n  });\n} else {\n  window.app = new ConductMedicineApp();\n  window.app.init();\n}\n\nexport default ConductMedicineApp;"],"file":"assets/index-DTVzPbXk.js"}